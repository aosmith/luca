(function(){var e,t=Array.prototype.slice;(window||global).Luca=function(){var e,n,r,i,s,o;s=arguments[0],e=2<=arguments.length?t.call(arguments,1):[];if(_.isString(s)&&(o=Luca.cache(s)))return o;if(_.isString(s)&&(o=Luca.find(s)))return o;if(_.isObject(s)&&s.ctype!=null)return Luca.util.lazyComponent(s);_.isObject(s)&&s.defines&&s["extends"]&&(n=s.defines,i=s["extends"]);if(_.isFunction(r=_(e).last()))return r()},_.extend(Luca,{VERSION:"0.9.45",core:{},containers:{},components:{},modules:{},util:{},fields:{},registry:{},options:{}}),_.extend(Luca,Backbone.Events),Luca.autoRegister=!0,Luca.developmentMode=!1,Luca.enableGlobalObserver=!1,Luca.enableBootstrap=!0,Luca.keys={ENTER:13,ESCAPE:27,KEYLEFT:37,KEYUP:38,KEYRIGHT:39,KEYDOWN:40,SPACEBAR:32,FORWARDSLASH:191},Luca.keyMap=_(Luca.keys).inject(function(e,t,n){return e[t]=n.toLowerCase(),e},{}),Luca.find=function(){return},Luca.supportsEvents=Luca.supportsBackboneEvents=function(e){return Luca.isComponent(e)||_.isFunction(e!=null?e.trigger:void 0)||_.isFunction(e!=null?e.bind:void 0)},Luca.isComponent=function(e){return Luca.isBackboneModel(e)||Luca.isBackboneView(e)||Luca.isBackboneCollection(e)},Luca.isComponentPrototype=function(e){return Luca.isViewPrototype(e)||Luca.isModelPrototype(e)||Luca.isCollectionPrototype(e)},Luca.isBackboneModel=function(e){return _.isString(e)&&(e=Luca.util.resolve(e)),_.isFunction(e!=null?e.set:void 0)&&_.isFunction(e!=null?e.get:void 0)&&_.isObject(e!=null?e.attributes:void 0)},Luca.isBackboneView=function(e){return _.isString(e)&&(e=Luca.util.resolve(e)),_.isFunction(e!=null?e.render:void 0)&&!_.isUndefined(e!=null?e.el:void 0)},Luca.isBackboneCollection=function(e){return _.isString(e)&&(e=Luca.util.resolve(e)),_.isFunction(e!=null?e.fetch:void 0)&&_.isFunction(e!=null?e.reset:void 0)},Luca.isViewPrototype=function(e){return _.isString(e)&&(e=Luca.util.resolve(e)),e!=null&&e.prototype!=null&&e.prototype.make!=null&&e.prototype.$!=null&&e.prototype.render!=null},Luca.isModelPrototype=function(e){return _.isString(e)&&(e=Luca.util.resolve(e)),e!=null&&(typeof e.prototype=="function"?e.prototype(e.prototype.save!=null&&e.prototype.changedAttributes!=null):void 0)},Luca.isCollectionPrototype=function(e){return _.isString(e)&&(e=Luca.util.resolve(e)),e!=null&&e.prototype!=null&&!Luca.isModelPrototype(e)&&e.prototype.reset!=null&&e.prototype.select!=null&&e.prototype.reject!=null},Luca.inheritanceChain=function(e){return _(Luca.parentClasses(e)).map(function(e){return Luca.util.resolve(e)})},Luca.parentClasses=function(e){var t,n,r;return n=[],_.isString(e)&&(e=Luca.util.resolve(e)),n.push(e.displayName||((r=e.prototype)!=null?r.displayName:void 0)||Luca.parentClass(e)),t=function(){var t;t=[];while(Luca.parentClass(e)!=null)t.push(e=Luca.parentClass(e));return t}(),n=n.concat(t),_.uniq(n)},Luca.parentClass=function(e){var t,n,r;t=[],_.isString(e)&&(e=Luca.util.resolve(e));if(Luca.isComponent(e))return e.displayName;if(Luca.isComponentPrototype(e))return typeof (n=e.prototype)._superClass=="function"?(r=n._superClass())!=null?r.displayName:void 0:void 0},Luca.template=function(e,t){var n,r,i,s,o;window.JST||(window.JST={});if(_.isFunction(e))return e(t);r=(o=Luca.templates)!=null?o[e]:void 0,n=typeof JST!="undefined"&&JST!==null?JST[e]:void 0,r==null&&n==null&&(i=new RegExp(""+e+"$"),r=_(Luca.templates).detect(function(e,t){return i.exec(t)}),n=_(JST).detect(function(e,t){return i.exec(t)}));if(!r&&!n)throw"Could not find template named "+e;return s=r||n,t!=null?s(t):s},Luca.available_templates=function(e){var t;return e==null&&(e=""),t=_(Luca.templates).keys(),e.length>0?_(t).select(function(t){return t.match(e)}):t},e={module:function(e,t){_.extend(e,t);if(e.included&&_(e.included).isFunction())return e.included.apply(e)},"delete":function(e,t){var n;return n=e[t],delete e[t],n},idle:function(e,t){var n;return t==null&&(t=1e3),window.DISABLE_IDLE&&(t=0),n=void 0,function(){return n&&window.clearTimeout(n),n=window.setTimeout(_.bind(e,this),t)}},idleShort:function(e,t){var n;return t==null&&(t=100),window.DISABLE_IDLE&&(t=0),n=void 0,function(){return n&&window.clearTimeout(n),n=window.setTimeout(_.bind(e,this),t)}},idleMedium:function(e,t){var n;return t==null&&(t=2e3),window.DISABLE_IDLE&&(t=0),n=void 0,function(){return n&&window.clearTimeout(n),n=window.setTimeout(_.bind(e,this),t)}},idleLong:function(e,t){var n;return t==null&&(t=5e3),window.DISABLE_IDLE&&(t=0),n=void 0,function(){return n&&window.clearTimeout(n),n=window.setTimeout(_.bind(e,this),t)}}},_.mixin(e)}).call(this),function(){Luca.templates||(Luca.templates={}),Luca.templates["components/bootstrap_form_controls"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("<div class='form-actions'>\n  <a class='btn btn-primary submit-button'>\n    <i class='icon-ok icon-white'></i>\n    Save Changes\n  </a>\n  <a class='btn reset-button cancel-button'>\n    <i class='icon-remove'></i>\n    Cancel\n  </a>\n</div>\n");return __p.join("")}}.call(this),function(){Luca.templates||(Luca.templates={}),Luca.templates["components/collection_loader_view"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("<div class='modal' id='progress-model' style='display: none;'>\n  <div class='progress progress-info progress-striped active'>\n    <div class='bar' style='width: 0%;'></div>\n  </div>\n  <div class='message'>\n    Initializing...\n  </div>\n</div>\n");return __p.join("")}}.call(this),function(){Luca.templates||(Luca.templates={}),Luca.templates["components/form_alert"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("<div class='",className,"'>\n  <a class='close' data-dismiss='alert' href='#'>x</a>\n  ",message,"\n</div>\n");return __p.join("")}}.call(this),function(){Luca.templates||(Luca.templates={}),Luca.templates["components/grid_view"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("<div class='luca-ui-g-view-wrapper'>\n  <div class='g-view-header'></div>\n  <div class='luca-ui-g-view-body'>\n    <table cellpadding='0' cellspacing='0' class='luca-ui-g-view scrollable-table' width='100%'>\n      <thead class='fixed'></thead>\n      <tbody class='scrollable'></tbody>\n    </table>\n  </div>\n  <div class='luca-ui-g-view-footer'></div>\n</div>\n");return __p.join("")}}.call(this),function(){Luca.templates||(Luca.templates={}),Luca.templates["components/grid_view_empty_text"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("<div class='empty-text-wrapper'>\n  <p>\n    ",text,"\n  </p>\n</div>\n");return __p.join("")}}.call(this),function(){Luca.templates||(Luca.templates={}),Luca.templates["components/load_mask"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("<div class='load-mask'>\n  <div class='progress progress-striped active'>\n    <div class='bar' style='width:1%'></div>\n  </div>\n</div>\n");return __p.join("")}}.call(this),function(){Luca.templates||(Luca.templates={}),Luca.templates["components/nav_bar"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("<div class='navbar-inner'>\n  <div class='luca-ui-navbar-body container'></div>\n</div>\n");return __p.join("")}}.call(this),function(){Luca.templates||(Luca.templates={}),Luca.templates["containers/basic"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("<div class='",classes,"' id='",id,"' style='",style,"'></div>\n");return __p.join("")}}.call(this),function(){Luca.templates||(Luca.templates={}),Luca.templates["containers/tab_selector_container"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{}){__p.push("<div class='tab-selector-container' id='",cid,"-tab-selector'>\n  <ul class='nav nav-tabs' id='",cid,"-tabs-nav'>\n    ");for(var i=0;i<components.length;i++){__p.push("\n    ");var component=components[i];__p.push("\n    <li class='tab-selector' data-target='",i,"'>\n      <a data-target='",i,"'>\n        ",component.title,"\n      </a>\n    </li>\n    ")}__p.push("\n  </ul>\n</div>\n")}return __p.join("")}}.call(this),function(){Luca.templates||(Luca.templates={}),Luca.templates["containers/tab_view"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("<ul class='nav ",navClass,"' id='",cid,"-tabs-selector'></ul>\n<div class='tab-content' id='",cid,"-tab-view-content'></div>\n");return __p.join("")}}.call(this),function(){Luca.templates||(Luca.templates={}),Luca.templates["containers/toolbar_wrapper"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("<div class='luca-ui-toolbar-wrapper' id='",id,"'></div>\n");return __p.join("")}}.call(this),function(){Luca.templates||(Luca.templates={}),Luca.templates["fields/button_field"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("<label>&nbsp</label>\n<input class='btn ",input_class,"' id='",input_id,"' style='",inputStyles,"' type='",input_type,"' value='",input_value,"' />\n");return __p.join("")}}.call(this),function(){Luca.templates||(Luca.templates={}),Luca.templates["fields/button_field_link"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("<a class='btn ",input_class,"'>\n  "),icon_class.length&&__p.push("\n  <i class='",icon_class,"'></i>\n  "),__p.push("\n  ",input_value,"\n</a>\n");return __p.join("")}}.call(this),function(){Luca.templates||(Luca.templates={}),Luca.templates["fields/checkbox_array"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("<div class='control-group'>\n  <label for='",input_id,"'>\n    ",label,"\n  </label>\n  <div class='controls'></div>\n</div>\n");return __p.join("")}}.call(this),function(){Luca.templates||(Luca.templates={}),Luca.templates["fields/checkbox_array_item"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("<label for='",input_id,"'>\n  <input id='",input_id,"' name='",input_name,"' type='checkbox' value='",value,"' />\n  ",label,"\n</label>\n");return __p.join("")}}.call(this),function(){Luca.templates||(Luca.templates={}),Luca.templates["fields/checkbox_field"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("<label for='",input_id,"'>\n  ",label,"\n  <input name='",input_name,"' style='",inputStyles,"' type='checkbox' value='",input_value,"' />\n</label>\n"),helperText&&__p.push("\n<p class='helper-text help-block'>\n  ",helperText,"\n</p>\n"),__p.push("\n");return __p.join("")}}.call(this),function(){Luca.templates||(Luca.templates={}),Luca.templates["fields/file_upload_field"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("<label for='",input_id,"'>\n  ",label,"\n</label>\n<input id='",input_id,"' name='",input_name,"' style='",inputStyles,"' type='file' />\n"),helperText&&__p.push("\n<p class='helper-text help-block'>\n  ",helperText,"\n</p>\n"),__p.push("\n");return __p.join("")}}.call(this),function(){Luca.templates||(Luca.templates={}),Luca.templates["fields/hidden_field"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("<input id='",input_id,"' name='",input_name,"' type='hidden' value='",input_value,"' />\n");return __p.join("")}}.call(this),function(){Luca.templates||(Luca.templates={}),Luca.templates["fields/select_field"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("<label for='",input_id,"'>\n  ",label,"\n</label>\n<div class='controls'>\n  <select id='",input_id,"' name='",input_name,"' style='",inputStyles,"'></select>\n  "),helperText&&__p.push("\n  <p class='helper-text help-block'>\n    ",helperText,"\n  </p>\n  "),__p.push("\n</div>\n");return __p.join("")}}.call(this),function(){Luca.templates||(Luca.templates={}),Luca.templates["fields/text_area_field"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("<label for='",input_id,"'>\n  ",label,"\n</label>\n<textarea class='",input_class,"' id='",input_id,"' name='",input_name,"' style='",inputStyles,"'></textarea>\n"),helperText&&__p.push("\n<p class='helper-text help-block'>\n  ",helperText,"\n</p>\n"),__p.push("\n");return __p.join("")}}.call(this),function(){Luca.templates||(Luca.templates={}),Luca.templates["fields/text_field"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push(""),(typeof label!="undefined"&&typeof hideLabel!="undefined"&&!hideLabel||typeof hideLabel=="undefined")&&__p.push("\n<label class='control-label' for='",input_id,"'>\n  ",label,"\n</label>\n"),__p.push("\n<div class='controls'>\n  "),typeof addOn!="undefined"&&__p.push("\n  <span class='add-on'>\n    ",addOn,"\n  </span>\n  "),__p.push("\n  <input class='",input_class,"' id='",input_id,"' name='",input_name,"' placeholder='",placeHolder,"' style='",inputStyles,"' type='text' />\n  "),helperText&&__p.push("\n  <p class='helper-text help-block'>\n    ",helperText,"\n  </p>\n  "),__p.push("\n</div>\n");return __p.join("")}}.call(this),function(){Luca.templates||(Luca.templates={}),Luca.templates["sample/contents"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("<p>Sample Contents</p>\n");return __p.join("")}}.call(this),function(){Luca.templates||(Luca.templates={}),Luca.templates["sample/welcome"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("welcome.luca\n");return __p.join("")}}.call(this),function(){Luca.templates||(Luca.templates={}),Luca.templates.table_view=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push("<thead></thead>\n<tbody class='table-body'></tbody>\n<tfoot></tfoot>\n<caption></caption>\n");return __p.join("")}}.call(this),function(){var currentNamespace;Luca.util.resolve=function(e,t){return t||(t=window||global),_(e.split(/\./)).inject(function(e,t){return e=e!=null?e[t]:void 0},t)},Luca.util.nestedValue=Luca.util.resolve,Luca.util.argumentsLogger=function(e){return function(){return console.log(e,arguments)}},Luca.util.classify=function(e){return e==null&&(e=""),_.string.camelize(_.string.capitalize(e))},Luca.util.hook=function(e){var t,n,r;return e==null&&(e=""),n=e.split(":"),r=n.shift(),n=_(n).map(function(e){return _.string.capitalize(e)}),t=r+n.join("")},Luca.util.isIE=function(){try{return Object.defineProperty({},"",{}),!1}catch(e){return!0}},currentNamespace=window||global,Luca.util.namespace=function(namespace){return namespace==null?currentNamespace:(currentNamespace=_.isString(namespace)?Luca.util.resolve(namespace,window||global):namespace,currentNamespace!=null?currentNamespace:currentNamespace=eval("(window||global)."+namespace+" = {}"))},Luca.util.lazyComponent=function(config){var componentClass,constructor,ctype;_.isObject(config)&&(ctype=config.ctype||config.type),_.isString(config)&&(ctype=config),componentClass=Luca.registry.lookup(ctype);if(!componentClass)throw"Invalid Component Type: "+ctype+".  Did you forget to register it?";return constructor=eval(componentClass),new constructor(config)},Luca.util.selectProperties=function(e,t,n){var r;return r=_(t).values(),_(r).select(e)},Luca.util.loadScript=function(e,t){var n;return n=document.createElement("script"),n.type="text/javascript",n.readyState&&(n.onreadystatechange=function(){return n.readyState==="loaded"||n.readyState==="complete"?(n.onreadystatechange=null,t()):n.onload=function(){return t()}}),n.src=e,document.body.appendChild(n)},Luca.util.make=Backbone.View.prototype.make,Luca.util.list=function(e,t,n){var r,i,s,o;t==null&&(t={}),r=n?"ol":"ul",r=Luca.util.make(r,t);if(_.isArray(e))for(s=0,o=e.length;s<o;s++)i=e[s],$(r).append(Luca.util.make("li",{},i));return r.outerHTML},Luca.util.label=function(e,t,n){var r;return e==null&&(e=""),n==null&&(n="label"),r=n,t!=null&&(r+=" "+n+"-"+t),Luca.util.make("span",{"class":r},e)},Luca.util.badge=function(e,t,n){var r;return e==null&&(e=""),n==null&&(n="badge"),r=n,t!=null&&(r+=" "+n+"-"+t),Luca.util.make("span",{"class":r},e)}}.call(this),function(){Luca.DevelopmentToolHelpers={refreshCode:function(){var e;return e=this,_(this.eventHandlerProperties()).each(function(t){return e[t]=e.definitionClass()[t]}),this.autoBindEventHandlers===!0&&this.bindAllEventHandlers(),this.delegateEvents()},eventHandlerProperties:function(){var e;return e=_(this.events).values(),_(e).select(function(e){return _.isString(e)})},eventHandlerFunctions:function(){var e,t=this;return e=_(this.events).values(),_(e).map(function(e){return _.isFunction(e)?e:t[e]})}}}.call(this),function(){var e;e=function(){function e(e,t,n){var r,i=this;this.object=e,n==null&&(n=!0),_.isFunction(t)?r=t:_.isString(t)&&_.isFunction(this.object[t])&&(r=this.object[t]);if(!_.isFunction(r))throw"Must pass a function or a string representing one";n===!0?this.fn=function(){return _.defer(r)}:this.fn=r,this}return e.prototype.until=function(e,t){return e!=null&&t==null&&(t=e,e=this.object),e.once(t,this.fn),this.object},e}(),Luca.Events={defer:function(t,n){return n==null&&(n=!0),new e(this,t,n)},once:function(e,t,n){var r;return n||(n=this),r=function(){return t.apply(n,arguments),this.unbind(e,r)},this.bind(e,r)}}}.call(this),function(){var DefineProxy;Luca.define=function(e){return new DefineProxy(e)},Luca.component=Luca.define,DefineProxy=function(){function DefineProxy(e){var t;this.namespace=Luca.util.namespace(),this.componentId=this.componentName=e,e.match(/\./)&&(this.namespaced=!0,t=e.split("."),this.componentId=t.pop(),this.namespace=t.join("."),Luca.registry.addNamespace(t.join(".")))}return DefineProxy.prototype["in"]=function(e){return this.namespace=e,this},DefineProxy.prototype.from=function(e){return this.superClassName=e,this},DefineProxy.prototype["extends"]=function(e){return this.superClassName=e,this},DefineProxy.prototype.extend=function(e){return this.superClassName=e,this},DefineProxy.prototype.enhance=function(e){return e!=null?this["with"](e):this},DefineProxy.prototype["with"]=function(properties){var at,componentType,_base;return at=this.namespaced?Luca.util.resolve(this.namespace,window||global):window||global,this.namespaced&&at==null&&(eval("(window||global)."+this.namespace+" = {}"),at=Luca.util.resolve(this.namespace,window||global)),at[this.componentId]=Luca.extend(this.superClassName,this.componentName,properties),Luca.autoRegister===!0&&(Luca.isViewPrototype(at[this.componentId])&&(componentType="view"),Luca.isCollectionPrototype(at[this.componentId])&&((_base=Luca.Collection).namespaces||(_base.namespaces=[]),Luca.Collection.namespaces.push(this.namespace),componentType="collection"),Luca.isModelPrototype(at[this.componentId])&&(componentType="model"),Luca.register(_.string.underscored(this.componentId),this.componentName,componentType)),at[this.componentId]},DefineProxy}(),Luca.extend=function(e,t,n){var r,i,s,o,u,a;n==null&&(n={}),s=Luca.util.resolve(e,window||global);if(!_.isFunction(s!=null?s.extend:void 0))throw""+e+" is not a valid component to extend from";n.displayName=t,n._superClass=function(){return s.displayName||(s.displayName=e),s},n._super=function(e,t,n){var r;return(r=this._superClass().prototype[e])!=null?r.apply(t,n):void 0},r=s.extend(n);if(_.isArray(n!=null?n.include:void 0)){a=n.include;for(o=0,u=a.length;o<u;o++)i=a[o],_.isString(i)&&(i=Luca.util.resolve(i)),_.extend(r.prototype,i)}return r},Luca.mixin=function(e){var t;return t=_(Luca.mixin.namespaces).detect(function(t){return Luca.util.resolve(t)[e]!=null}),Luca.util.resolve(t)[e]},Luca.mixin.namespaces=["Luca.modules"],Luca.mixin.namespace=function(e){return Luca.mixin.namespaces.push(e),Luca.mixin.namespaces=_(Luca.mixin.namespaces).uniq()},Luca.decorate=function(e){return _.isString(e)&&(e=Luca.util.resolve(e).prototype),{"with":function(t){return _.extend(e,Luca.mixin(t)),e.mixins||(e.mixins=[]),e.mixins.push(t),e.mixins=_(e.mixins).uniq(),e}}},_.mixin({def:Luca.define})}.call(this),function(){Luca.modules.Deferrable={configure_collection:function(e){var t,n,r;e==null&&(e=!0);if(!this.collection)return;_.isString(this.collection)&&(t=(n=Luca.CollectionManager)!=null?n.get():void 0)&&(this.collection=t.getOrCreate(this.collection)),this.collection&&_.isFunction(this.collection.fetch)&&_.isFunction(this.collection.reset)||(this.collection=new Luca.Collection(this.collection.initial_set,this.collection));if((r=this.collection)!=null?r.deferrable_trigger:void 0)this.deferrable_trigger=this.collection.deferrable_trigger;if(e)return this.deferrable=this.collection}}}.call(this),function(){var e,t=Object.prototype.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};Luca.modules.FilterableView={_initializer:function(){var t=this;return this.filterState=new e(this.filterableOptions),this.onFilterChange||(this.onFilterChange=this.refresh),this.filterState.on("change",function(e){var n;return t.trigger("change:filter",e.toQuery(),e.toOptions()),(n=t.onFilterChange)!=null?n.call(t,e.toQuery(),e.toOptions()):void 0})},getModels:function(){return this.collection.query(this.filterState.toQuery(),this.filterState.toOptions())},applyFilter:function(e,t){var n;return e==null&&(e={}),t==null&&(t={}),n=_(t)["delete"]("silent")===!0,this.filterState.set({query:e,options:t},{silent:n})}},e=function(e){function t(){t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.toQuery=function(){return this.get("query")},t.prototype.toOptions=function(){return this.get("options")},t}(Backbone.Model)}.call(this),function(){Luca.modules.GridLayout={_initializer:function(){this.gridSpan&&this.$el.addClass("span"+this.gridSpan),this.gridOffset&&this.$el.addClass("offset"+this.gridOffset),this.gridRowFluid&&this.$el.addClass("row-fluid");if(this.gridRow)return this.$el.addClass("row")}}}.call(this),function(){Luca.modules.LoadMaskable={_initializer:function(){var e=this;if(this.loadMask===!0)return this.defer(function(){e.$el.addClass("with-mask");if(e.$(".load-mask").length===0)return e.loadMaskTarget().prepend(Luca.template(e.loadMaskTemplate,e)),e.$(".load-mask").hide()}).until("after:render"),this.on(this.loadmaskEnableEvent||"enable:loadmask",this.applyLoadMask),this.on(this.loadmaskDisableEvent||"disable:loadmask",this.applyLoadMask)},showLoadMask:function(){return this.trigger("enable:loadmask")},hideLoadMask:function(){return this.trigger("disable:loadmask")},loadMaskTarget:function(){return this.loadMaskEl!=null?this.$(this.loadMaskEl):this.$bodyEl()},disableLoadMask:function(){return this.$(".load-mask .bar").css("width","100%"),this.$(".load-mask").hide(),clearInterval(this.loadMaskInterval)},enableLoadMask:function(){var e,t=this;this.$(".load-mask").show().find(".bar").css("width","0%"),e=this.$(".load-mask .progress").width(),e<20&&(e=this.$el.width())<20&&(e=this.$el.parent().width()),this.loadMaskInterval=setInterval(function(){var e,n;return e=t.$(".load-mask .bar").width(),n=e+12,t.$(".load-mask .bar").css("width",n)},200);if(this.loadMaskTimeout==null)return;return _.delay(function(){return t.disableLoadMask()},this.loadMaskTimeout)},applyLoadMask:function(){return this.$(".load-mask").is(":visible")?this.disableLoadMask():this.enableLoadMask()}}}.call(this),function(){Luca.LocalStore=function(){function e(e){var t;this.name=e,t=localStorage.getItem(this.name),this.data=t&&JSON.parse(t)||{}}return e.prototype.guid=function(){var e;return e=function(){return((1+Math.random())*65536|0).toString(16).substring(1)},e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},e.prototype.save=function(){return localStorage.setItem(this.name,JSON.stringify(this.data))},e.prototype.create=function(e){return e.id||(e.id=e.attribtues.id=this.guid()),this.data[e.id]=e,this.save(),e},e.prototype.update=function(e){return this.data[e.id]=e,this.save(),e},e.prototype.find=function(e){return this.data[e.id]},e.prototype.findAll=function(){return _.values(this.data)},e.prototype.destroy=function(e){return delete this.data[e.id],this.save(),e},e}(),Backbone.LocalSync=function(e,t,n){var r,i;return i=t.localStorage||t.collection.localStorage,r=function(){switch(e){case"read":return t.id?i.find(t):i.findAll();case"create":return i.create(t);case"update":return i.update(t);case"delete":return i.destroy(t)}}(),r?n.success(r):n.error("Record not found")}}.call(this),function(){var e,t;t={classes:{},model_classes:{},collection_classes:{},namespaces:["Luca.containers","Luca.components"]},e={cid_index:{},name_index:{}},Luca.defaultComponentType="view",Luca.registry.aliases={grid:"grid_view",form:"form_view",text:"text_field",button:"button_field",select:"select_field",card:"card_view",paged:"card_view",wizard:"card_view",collection:"collection_view"},Luca.register=function(e,n,r){r==null&&(r="view"),Luca.trigger("component:registered",e,n);switch(r){case"model":return t.model_classes[e]=n;case"collection":return t.collection_classes[e]=n;default:return t.classes[e]=n}},Luca.development_mode_register=function(e,n){var r,i,s;return r=t.classes[e],Luca.enableDevelopmentTools===!0&&r!=null&&(s=Luca.util.resolve(r,window),i=Luca.registry.findInstancesByClassName(n),_(i).each(function(e){var t;return e!=null?(t=e.refreshCode)!=null?t.call(e,s):void 0:void 0})),Luca.register(e,n)},Luca.registry.addNamespace=Luca.registry.namespace=function(e){return t.namespaces.push(e),t.namespaces=_(t.namespaces).uniq()},Luca.registry.namespaces=function(e){return e==null&&(e=!0),_(t.namespaces).map(function(t){return e?Luca.util.resolve(t):t})},Luca.registry.lookup=function(e){var n,r,i,s,o,u;if(n=Luca.registry.aliases[e])e=n;return r=t.classes[e],r!=null?r:(i=Luca.util.classify(e),o=Luca.registry.namespaces(),s=(u=_(o).chain().map(function(e){return e[i]}).compact().value())!=null?u[0]:void 0)},Luca.registry.instances=function(){return _(e.cid_index).values()},Luca.registry.findInstancesByClassName=function(e){var t;return t=Luca.registry.instances(),_(t).select(function(t){var n;return t.displayName===e||(typeof t._superClass=="function"?(n=t._superClass())!=null?n.displayName:void 0:void 0)===e})},Luca.registry.classes=function(e){return e==null&&(e=!1),_(_.extend({},t.classes,t.model_classes,t.collection_classes)).map(function(t,n){return e?t:{className:t,ctype:n}})},Luca.cache=function(t,n){var r;return n!=null&&(e.cid_index[t]=n),n=e.cid_index[t],(n!=null?n.component_name:void 0)!=null?e.name_index[n.component_name]=n.cid:(n!=null?n.name:void 0)!=null&&(e.name_index[n.name]=n.cid),n!=null?n:(r=e.name_index[t],e.cid_index[r])}}.call(this),function(){var e=Array.prototype.slice;Luca.Observer=function(){function t(e){var t=this;this.options=e!=null?e:{},_.extend(this,Backbone.Events),this.type=this.options.type,this.options.debugAll&&this.bind("all",function(e,t,n){return console.log("ALL",e,t,n)})}return t.prototype.relay=function(){var t,n;return n=arguments[0],t=2<=arguments.length?e.call(arguments,1):[],console.log("Relaying",trigger,t),this.trigger("event",n,t),this.trigger("event:"+t[0],n,t.slice(1))},t}(),Luca.Observer.enableObservers=function(e){return e==null&&(e={}),Luca.enableGlobalObserver=!0,Luca.ViewObserver=new Luca.Observer(_.extend(e,{type:"view"})),Luca.CollectionObserver=new Luca.Observer(_.extend(e,{type:"collection"}))}}.call(this),function(){var e,t,n,r,i,s,o;_.def("Luca.View")["extends"]("Backbone.View")["with"]({include:["Luca.Events"],additionalClassNames:[],hooks:["before:initialize","after:initialize","before:render","after:render","first:activation","activation","deactivation"],initialize:function(u){var a,f,l,c,h,p;this.options=u!=null?u:{},this.trigger("before:initialize",this,this.options),_.extend(this,this.options),(this.autoBindEventHandlers===!0||this.bindAllEvents===!0)&&e.call(this),r.call(this),this.name!=null&&(this.cid=_.uniqueId(this.name)),Luca.cache(this.cid,this),this.setupHooks(_(Luca.View.prototype.hooks.concat(this.hooks)).uniq()),i.call(this),this.stateful===!0&&this.state==null&&s.call(this),n.call(this),t.call(this);if(((c=this.mixins)!=null?c.length:void 0)>0){h=_.uniq(this.mixins);for(f=0,l=h.length;f<l;f++)a=h[f],(p=Luca.mixin(a))!=null&&p._initializer.call(this,this,a)}return this.delegateEvents(),this.template&&!this.isField&&o.call(this),this.trigger("after:initialize",this)},$wrap:function(e){return _.isString(e)&&!e.match(/[<>]/)&&(e=this.make("div",{"class":e})),this.$el.wrap(e)},$template:function(e,t){return t==null&&(t={}),this.$el.html(Luca.template(e,t))},$html:function(e){return this.$el.html(e)},$append:function(e){return this.$el.append(e)},$attach:function(){return this.$container().append(this.el)},$bodyEl:function(){return this.$el},$container:function(){return $(this.container)},setupHooks:function(e){var t=this;return e||(e=this.hooks),_(e).each(function(e){var n,r;r=Luca.util.hook(e),n=function(){var e;return(e=t[r])!=null?e.apply(t,arguments):void 0};if(e!=null?e.match(/once:/):void 0)n=_.once(n);return t.bind(e,n)})},registerEvent:function(e,t){return this.events||(this.events={}),this.events[e]=t,this.delegateEvents()},definitionClass:function(){var e;return(e=Luca.util.resolve(this.displayName,window))!=null?e.prototype:void 0},collections:function(){return Luca.util.selectProperties(Luca.isBackboneCollection,this)},models:function(){return Luca.util.selectProperties(Luca.isBackboneModel,this)},views:function(){return Luca.util.selectProperties(Luca.isBackboneView,this)},debug:function(){var e,t,n,r;if(!this.debugMode&&window.LucaDebugMode==null)return;r=[];for(t=0,n=arguments.length;t<n;t++)e=arguments[t],r.push(console.log([this.name||this.cid,e]));return r},trigger:function(){return Luca.enableGlobalObserver&&(Luca.developmentMode===!0||this.observeEvents===!0)&&(Luca.ViewObserver||(Luca.ViewObserver=new Luca.Observer({type:"view"})),Luca.ViewObserver.relay(this,arguments)),Backbone.View.prototype.trigger.apply(this,arguments)}}),Luca.View._originalExtend=Backbone.View.extend,Luca.View.renderWrapper=function(e){var t;return t=e.render,t||(t=Luca.View.prototype.$attach),e.render=function(){var e,n,r,i,s,o,u=this;return o=this,this.deferrable?(i=this.deferrable_target,Luca.isBackboneCollection(this.deferrable)||(this.deferrable=this.collection),i||(i=this.deferrable),s=this.deferrable_event?this.deferrable_event:Luca.View.deferrableEvent,n=function(){return t.call(o),o.trigger("after:render",o)},o.defer(n).until(i,s),o.trigger("before:render",this),e=this.deferrable_trigger||this.deferUntil,e==null?i[this.deferrable_method||"fetch"].call(i):(r=_.once(function(){var e,t;return typeof (e=u.deferrable)[t=u.deferrable_method||"fetch"]=="function"?e[t]():void 0}),(this.deferrable_target||this).bind(this.deferrable_trigger,r)),this):(this.trigger("before:render",this),t.apply(this,arguments),this.trigger("after:render",this),this)},e},e=function(){var e=this;return _(this.events).each(function(t,n){if(_.isString(t))return _.bindAll(e,t)})},t=function(){var e,t,n,r,i,s,o;if(_.isEmpty(this.applicationEvents))return;e=this.app;if(_.isString(e)||_.isUndefined(e))e=(i=Luca.Application)!=null?typeof i.get=="function"?i.get(e):void 0:void 0;if(!Luca.supportsEvents(e))throw"Error binding to the application object on "+(this.name||this.cid);s=this.applicationEvents,o=[];for(n=0,r=s.length;n<r;n++){t=s[n],_.isString(n)&&(n=this[n]);if(!_.isFunction(n))throw"Error registering application event "+t+" on "+(this.name||this.cid);o.push(e.on(t,n))}return o},n=function(){var e,t,n,r,i,s,o,u,a;if(_.isEmpty(this.collectionEvents))return;i=this.collectionManager;if(_.isString(i)||_.isUndefined(i))i=Luca.CollectionManager.get(i);o=this.collectionEvents,a=[];for(s in o){n=o[s],u=s.split(" "),r=u[0],t=u[1],e=i.getOrCreate(r);if(!e)throw"Could not find collection specified by "+r;_.isString(n)&&(n=this[n]);if(!_.isFunction(n))throw"invalid collectionEvents configuration";try{a.push(e.bind(t,n))}catch(f){throw console.log("Error Binding To Collection in registerCollectionEvents",this),f}}return a},i=function(){var e,t,n,r,i;t=_(this.additionalClassNames||[]).clone(),this.wrapperClass!=null&&this.$wrap(this.wrapperClass),_.isString(t)&&(t=t.split(" ")),this.gridSpan&&t.push("span"+this.gridSpan),this.gridOffset&&t.push("offset"+this.gridOffset),this.gridRowFluid&&t.push("row-fluid"),this.gridRow&&t.push("row");if(t==null)return;i=[];for(n=0,r=t.length;n<r;n++)e=t[n],i.push(this.$el.addClass
(e));return i},s=function(){var e=this;return this.state=new Backbone.Model(this.defaultState||{}),this.set||(this.set=function(){return e.state.set.apply(e.state,arguments)}),this.get||(this.get=function(){return e.state.get.apply(e.state,arguments)})},r=function(){var e,t;t=this.bodyTemplateVars?this.bodyTemplateVars.call(this):this;if(e=this.bodyTemplate)return this.$el.empty(),Luca.View.prototype.$html.call(this,Luca.template(e,t))},o=function(){var e=this;if(this.template!=null)return this.defer(function(){return e.$template(e.template,e)}).until("before:render")},Luca.View.extend=function(e){var t,n,r,i;e=Luca.View.renderWrapper(e);if(e.mixins!=null&&_.isArray(e.mixins)){i=e.mixins;for(n=0,r=i.length;n<r;n++)t=i[n],Luca.decorate(e)["with"](t)}return Luca.View._originalExtend.call(this,e)},Luca.View.deferrableEvent="reset"}.call(this),function(){var e;e=function(){var e,t,n,r,i=this;if(_.isUndefined(this.computed))return;this._computed={},n=this.computed,r=[];for(e in n)t=n[e],this.on("change:"+e,function(){return i._computed[e]=i[e].call(i)}),_.isString(t)&&(t=t.split(",")),r.push(_(t).each(function(t){i.on("change:"+t,function(){return i.trigger("change:"+e)});if(i.has(t))return i.trigger("change:"+e)}));return r},_.def("Luca.Model")["extends"]("Backbone.Model")["with"]({include:["Luca.Events"],initialize:function(){return Backbone.Model.prototype.initialize(this,arguments),e.call(this)},get:function(e){var t;return((t=this.computed)!=null?t.hasOwnProperty(e):void 0)?this._computed[e]:Backbone.Model.prototype.get.call(this,e)}})}.call(this),function(){var e;e="Backbone.Collection",Backbone.QueryCollection!=null&&(e="Backbone.QueryCollection"),_.def("Luca.Collection")["extends"](e)["with"]({include:["Luca.Events"],cachedMethods:[],remoteFilter:!1,initialize:function(e,t){var n,r=this;e==null&&(e=[]),this.options=t,_.extend(this,this.options),this.setupMethodCaching(),this._reset(),this.cached&&console.log("The @cached property of Luca.Collection is being deprecated.  Please change to cache_key");if(this.cache_key||(this.cache_key=this.cached))this.bootstrap_cache_key=_.isFunction(this.cache_key)?this.cache_key():this.cache_key;(this.registerAs||this.registerWith)&&console.log("This configuration API is deprecated.  use @name and @manager properties instead"),this.name||(this.name=this.registerAs),this.manager||(this.manager=this.registerWith),this.manager=_.isFunction(this.manager)?this.manager():this.manager,this.name&&!this.manager&&(this.manager=Luca.CollectionManager.get()),this.manager&&(this.name||(this.name=this.cache_key()),this.name=_.isFunction(this.name)?this.name():this.name,!this.private&&!this.anonymous&&this.bind("after:initialize",function(){return r.register(r.manager,r.name,r)}));if(this.useLocalStorage===!0&&window.localStorage!=null)throw n=this.bootstrap_cache_key||this.name,"Must specify either a cached or registerAs property to use localStorage";return _.isArray(this.data)&&this.data.length>0&&(this.memoryCollection=!0),this.useNormalUrl!==!0&&this.__wrapUrl(),Backbone.Collection.prototype.initialize.apply(this,[e,this.options]),e&&this.reset(e,{silent:!0,parse:t!=null?t.parse:void 0}),this.trigger("after:initialize")},__wrapUrl:function(){var e,t,n=this;return _.isFunction(this.url)?this.url=_.wrap(this.url,function(e){var t,r,i,s,o;return o=e.apply(n),i=o.split("?"),i.length>1&&(t=_.last(i)),s=n.queryString(),t&&o.match(t)&&(s=s.replace(t,"")),r=""+o+"?"+s,r.match(/\?$/)&&(r=r.replace(/\?$/,"")),r}):(t=this.url,e=this.queryString(),this.url=_([t,e]).compact().join("?"))},queryString:function(){var e,t=this;return e=_(this.base_params||(this.base_params=Luca.Collection.baseParams())).inject(function(e,t,n){var r;return r=""+n+"="+t,e.push(r),e},[]),_.uniq(e).join("&")},resetFilter:function(){return this.base_params=_(Luca.Collection.baseParams()).clone(),this},applyFilter:function(e,t){return e==null&&(e={}),t==null&&(t={}),t.remote!=null==1||this.remoteFilter===!0?(this.applyParams(e),this.fetch(_.extend(t,{refresh:!0}))):this.reset(this.query(e))},applyParams:function(e){return this.base_params=_(Luca.Collection.baseParams()).clone(),_.extend(this.base_params,e),this},register:function(e,t,n){e==null&&(e=Luca.CollectionManager.get()),t==null&&(t="");if(!(t.length>=1))throw"Can not register with a collection manager without a key";if(e==null)throw"Can not register with a collection manager without a valid collection manager";_.isString(e)&&(e=Luca.util.nestedValue(e,window||global));if(!e)throw"Could not register with collection manager";if(_.isFunction(e.add))return e.add(t,n);if(_.isObject(e))return e[t]=n},loadFromBootstrap:function(){if(!this.bootstrap_cache_key)return;return this.reset(this.cached_models()),this.trigger("bootstrapped",this)},bootstrap:function(){return this.loadFromBootstrap()},cached_models:function(){return Luca.Collection.cache(this.bootstrap_cache_key)},fetch:function(e){var t;e==null&&(e={}),this.trigger("before:fetch",this);if(this.memoryCollection===!0)return this.reset(this.data);if(this.cached_models().length&&!e.refresh)return this.bootstrap();t=_.isFunction(this.url)?this.url():this.url;if(!(t&&t.length>1||this.localStorage))return!0;this.fetching=!0;try{return Backbone.Collection.prototype.fetch.apply(this,arguments)}catch(n){throw console.log("Error in Collection.fetch",n),n}},onceLoaded:function(e,t){var n,r=this;t==null&&(t={autoFetch:!0});if(this.length>0&&!this.fetching){e.apply(this,[this]);return}n=function(){return e.apply(r,[r])},this.bind("reset",function(){return n(),this.unbind("reset",this)});if(!this.fetching&&!!t.autoFetch)return this.fetch()},ifLoaded:function(e,t){var n,r=this;t==null&&(t={scope:this,autoFetch:!0}),n=t.scope||this,this.length>0&&!this.fetching&&e.apply(n,[this]),this.bind("reset",function(t){return e.call(n,t)});if(!(this.fetching===!0||!t.autoFetch||this.length>0))return this.fetch()},parse:function(e){var t;return this.fetching=!1,this.trigger("after:response",e),t=this.root!=null?e[this.root]:e,this.bootstrap_cache_key&&Luca.Collection.cache(this.bootstrap_cache_key,t),t},restoreMethodCache:function(){var e,t,n,r;n=this._methodCache,r=[];for(t in n)e=n[t],e.original!=null?(e.args=void 0,r.push(this[t]=e.original)):r.push(void 0);return r},clearMethodCache:function(e){return this._methodCache[e].value=void 0},clearAllMethodsCache:function(){var e,t,n,r;n=this._methodCache,r=[];for(t in n)e=n[t],r.push(this.clearMethodCache(t));return r},setupMethodCaching:function(){var e,t,n;return t=this,n=["reset","add","remove"],e=this._methodCache={},_(this.cachedMethods).each(function(r){var i,s,o,u,a,f,l,c,h;e[r]={name:r,original:t[r],value:void 0},t[r]=function(){var n;return(n=e[r]).value||(n.value=e[r].original.apply(t,arguments))};for(u=0,f=n.length;u<f;u++)o=n[u],t.bind(o,function(){return t.clearAllMethodsCache()});i=r.split(":")[1];if(i){c=i.split(","),h=[];for(a=0,l=c.length;a<l;a++)s=c[a],h.push(t.bind("change:"+s,function(){return t.clearMethodCache({method:r})}));return h}})},query:function(e,t){return e==null&&(e={}),t==null&&(t={}),Backbone.QueryCollection!=null?Backbone.QueryCollection.prototype.query.apply(this,arguments):this.models}}),_.extend(Luca.Collection.prototype,{trigger:function(){return Luca.enableGlobalObserver&&(Luca.CollectionObserver||(Luca.CollectionObserver=new Luca.Observer({type:"collection"})),Luca.CollectionObserver.relay(this,arguments)),Backbone.View.prototype.trigger.apply(this,arguments)}}),Luca.Collection.baseParams=function(e){if(e)return Luca.Collection._baseParams=e;if(_.isFunction(Luca.Collection._baseParams))return Luca.Collection._baseParams();if(_.isObject(Luca.Collection._baseParams))return Luca.Collection._baseParams},Luca.Collection._bootstrapped_models={},Luca.Collection.bootstrap=function(e){return _.extend(Luca.Collection._bootstrapped_models,e)},Luca.Collection.cache=function(e,t){return t?Luca.Collection._bootstrapped_models[e]=t:Luca.Collection._bootstrapped_models[e]||[]}}.call(this),function(){var e;e=function(e,t){var n,r,i,s,o;return e==null&&(e={}),e.orientation||(e.orientation="top"),e.ctype||(e.ctype=this.toolbarType||"panel_toolbar"),s=""+this.cid+"-tbc-"+e.orientation,o=Luca.util.lazyComponent(e),r=this.make("div",{"class":"toolbar-container "+e.orientation,id:s},o.render().el),i=this.bodyClassName||this.bodyTagName,n=function(){switch(e.orientation){case"top":case"left":return i?"before":"prepend";case"bottom":case"right":return i?"after":"append"}}(),(t||this.$bodyEl())[n](r)},_.def("Luca.components.Panel")["extends"]("Luca.View")["with"]({topToolbar:void 0,bottomToolbar:void 0,loadMask:!1,loadMaskTemplate:["components/load_mask"],loadMaskTimeout:3e3,mixins:["LoadMaskable"],initialize:function(e){return this.options=e!=null?e:{},Luca.View.prototype.initialize.apply(this,arguments)},applyStyles:function(e,t){var n,r,i;e==null&&(e={}),t==null&&(t=!1),r=t?this.$bodyEl():this.$el;for(n in e)i=e[n],r.css(n,i);return this},beforeRender:function(){var e;return(e=Luca.View.prototype.beforeRender)!=null&&e.apply(this,arguments),this.styles!=null&&this.applyStyles(this.styles),this.bodyStyles!=null&&this.applyStyles(this.bodyStyles,!0),typeof this.renderToolbars=="function"?this.renderToolbars():void 0},$bodyEl:function(){var e,t,n,r;return n=this.bodyTagName||"div",t=this.bodyClassName||"view-body",this.bodyEl||(this.bodyEl=""+n+"."+t),e=this.$(this.bodyEl),e.length>0?e:e.length!==0||this.bodyClassName==null&&this.bodyTagName==null?$(this.el):(r=this.make(n,{"class":t,"data-auto-appended":!0}),$(this.el).append(r),this.$(this.bodyEl))},$wrap:function(e){return _.isString(e)&&!e.match(/[<>]/)&&(e=this.make("div",{"class":e})),this.$el.wrap(e)},$template:function(e,t){return t==null&&(t={}),this.$html(Luca.template(e,t))},$empty:function(){return this.$bodyEl().empty()},$html:function(e){return this.$bodyEl().html(e)},$append:function(e){return this.$bodyEl().append(e)},renderToolbars:function(){var e=this;return _(["top","left","right","bottom"]).each(function(t){var n;if(n=e[""+t+"Toolbar"])return e.renderToolbar(t,n)})},renderToolbar:function(t,n){return t==null&&(t="top"),n==null&&(n={}),n.parent=this,n.orientation=t,e.call(this,n,n.targetEl)}})}.call(this),function(){_.def("Luca.core.Field")["extends"]("Luca.View")["with"]({className:"luca-ui-text-field luca-ui-field",isField:!0,template:"fields/text_field",labelAlign:"top",hooks:["before:validation","after:validation","on:change"],statuses:["warning","error","success"],initialize:function(e){var t;return this.options=e!=null?e:{},_.extend(this,this.options),this.input_id||(this.input_id=_.uniqueId("field")),this.input_name||(this.input_name=this.name),this.input_class||(this.input_class=""),this.helperText||(this.helperText=""),this.required&&((t=this.label)!=null?!t.match(/^\*/):!void 0)&&(this.label||(this.label="*"+this.label)),this.inputStyles||(this.inputStyles=""),this.disabled&&this.disable(),this.updateState(this.state),this.placeHolder||(this.placeHolder=""),Luca.View.prototype.initialize.apply(this,arguments)},beforeRender:function(){return Luca.enableBootstrap&&this.$el.addClass("control-group"),this.required&&this.$el.addClass("required"),this.$template(this.template,this),this.input=$("input",this.el)},change_handler:function(e){return this.trigger("on:change",this,e)},disable:function(){return $("input",this.el).attr("disabled",!0)},enable:function(){return $("input",this.el).attr("disabled",!1)},getValue:function(){var e;e=this.input.attr("value");if(_.str.isBlank(e))return e;switch(this.valueType){case"integer":return parseInt(e);case"string":return""+e;case"float":return parseFloat(e);default:return e}},render:function(){return $(this.container).append(this.$el)},setValue:function(e){return this.input.attr("value",e)},updateState:function(e){var t=this;return _(this.statuses).each(function(n){return t.$el.removeClass(n),t.$el.addClass(e)})}})}.call(this),function(){var e,t,n;n=function(){return this.trigger("before:layout",this),this.prepareLayout(),this.trigger("after:layout",this)},e=function(e,t){var n,r;return r=[],e.height!=null&&r.push("height: "+(_.isNumber(e.height)?e.height+"px":e.height)),e.width!=null&&r.push("width: "+(_.isNumber(e.width)?e.width+"px":e.width)),e.float&&r.push("float: "+e.float),n={"class":(e!=null?e.classes:void 0)||this.componentClass,id:""+this.cid+"-"+t,style:r.join(";"),"data-luca-owner":this.name||this.cid},this.customizeContainerEl!=null&&(n=this.customizeContainerEl(n,e,t)),n},t=function(){return this.trigger("before:components",this,this.components),this.prepareComponents(),this.createComponents(),this.trigger("before:render:components",this,this.components),this.renderComponents(),this.trigger("after:components",this,this.components)},_.def("Luca.core.Container")["extends"]("Luca.components.Panel")["with"]({className:"luca-ui-container",componentTag:"div",componentClass:"luca-ui-panel",isContainer:!0,hooks:["before:components","before:render:components","before:layout","after:components","after:layout","first:activation"],rendered:!1,components:[],initialize:function(e){return this.options=e!=null?e:{},_.extend(this,this.options),this.setupHooks(["before:components","before:render:components","before:layout","after:components","after:layout","first:activation"]),Luca.View.prototype.initialize.apply(this,arguments)},beforeRender:function(){var e;return n.call(this),t.call(this),(e=Luca.components.Panel.prototype.beforeRender)!=null?e.apply(this,arguments):void 0},customizeContainerEl:function(e,t,n){return e},prepareLayout:function(){var t;return t=this,this.componentContainers=_(this.components).map(function(n,r){return e.call(t,n,r)})},prepareComponents:function(){var e,t,n,r,i=this;r=this.components;for(t=0,n=r.length;t<n;t++)e=r[t],_.isString(e)&&(e={type:e});return _(this.components).each(function(e,t){var n,r,s,o;n=r=(o=i.componentContainers)!=null?o[t]:void 0,n["class"]=n["class"]||n.className||n.classes,i.generateComponentElements&&(s=i.make(i.componentTag,r,""),i.$append(s));if(e.container==null)return i.generateComponentElements&&(e.container="#"+r.id),e.container||(e.container=i.$bodyEl())})},createComponents:function(){var e,t,n=this;if(this.componentsCreated===!0)return;return t=this.componentIndex={name_index:{},cid_index:{}},e=this,this.components=_(this.components).map(function(n,r){var i,s;return i=Luca.isBackboneView(n)?n:(n.type||(n.type=n.ctype),n.type==null?n.components!=null?n.type=n.ctype="container":n.type=n.ctype=Luca.defaultComponentType:void 0,n=_.defaults(n,e.defaults||{}),s=Luca.util.lazyComponent(n)),_.isString(i.getter)&&(e[i.getter]=function(){return i}),!i.container&&i.options.container&&(i.container=i.options.container),t&&i.cid!=null&&(t.cid_index[i.cid]=r),t&&i.name!=null&&(t.name_index[i.name]=r),i}),this.componentsCreated=!0,this.defaults!=null&&console.log("Created With Defaults",_(this.components).map(function(e){return e.defaultProperty})),_.isEmpty(this.componentEvents)||this.registerComponentEvents(),t},renderComponents:function(e){var t;return this.debugMode=e!=null?e:"",this.debug("container render components"),t=this,_(this.components).each(function(e){e.getParent=function(){return t};try{return $(e.container).append(e.el),e.render()}catch(n){console.log("Error Rendering Component "+(e.name||e.cid),e),_.isObject(n)&&(console.log(n.message),console.log(n.stack));if(Luca.silenceRenderErrors!=null!=1)throw n}})},firstActivation:function(){var e;return e=this,this.each(function(t,n){var r;if((t!=null?t.previously_activated:void 0)!==!0)return t!=null&&(r=t.trigger)!=null&&r.call(t,"first:activation",t,e),t.previously_activated=!0})},pluck:function(e){return _(this.components).pluck(e)},invoke:function(e){return _(this.components).invoke(e)},map:function(e){return _(this.components).map(e)},componentEvents:{},registerComponentEvents:function(){var e,t,n,r,i,s,o,u;s=this.componentEvents,u=[];for(r in s)n=s[r],o=r.split(" "),t=o[0],i=o[1],e=this.findComponentByName(t),u.push(e!=null?e.bind(i,this[n]):void 0);return u},findComponentByName:function(e,t){return t==null&&(t=!1),this.findComponent(e,"name_index",t)},findComponentById:function(e,t){return t==null&&(t=!1),this.findComponent(e,"cid_index",t)},findComponent:function(e,t,n){var r,i,s,o,u;t==null&&(t="name"),n==null&&(n=!1),this.componentsCreated!==!0&&this.createComponents(),i=(o=this.componentIndex)!=null?o[t][e]:void 0,r=(u=this.components)!=null?u[i]:void 0;if(r)return r;if(n===!0)return s=_(this.components).detect(function(n){return n!=null?typeof n.findComponent=="function"?n.findComponent(e,t,!0):void 0:void 0}),s!=null?typeof s.findComponent=="function"?s.findComponent(e,t,!0):void 0:void 0},each:function(e){return this.eachComponent(e,!1)},eachComponent:function(e,t){var n=this;return t==null&&(t=!0),_(this.components).each(function(n,r){var i;e.call(n,n,r);if(t)return n!=null?(i=n.eachComponent)!=null?i.apply(n,[e,t]):void 0:void 0})},indexOf:function(e){var t;return t=_(this.components).pluck("name"),_(t).indexOf(e)},activeComponent:function(){return this.activeItem?this.components[this.activeItem]:this},componentElements:function(){return this.$(">."+this.componentClass,this.$bodyEl())},getComponent:function(e){return this.components[e]},rootComponent:function(){return console.log("Calling rootComponent will be deprecated.  use isRootComponent instead"),this.getParent==null},isRootComponent:function(){return this.getParent==null},getRootComponent:function(){return this.rootComponent()?this:this.getParent().getRootComponent()},selectByAttribute:function(e,t,n){var r;return n==null&&(n=!1),r=_(this.components).map(function(r){var i,s;return i=[],s=r[e],s===t&&i.push(r),n===!0&&i.push(typeof r.selectByAttribute=="function"?r.selectByAttribute(e,t,!0):void 0),_.compact(i)}),_.flatten(r)},select:function(e,t,n){return n==null&&(n=!1),console.log("Container.select will be replaced by selectByAttribute in 1.0"),Luca.core.Container.prototype.selectByAttribute.apply(this,arguments)}}),Luca.core.Container.componentRenderer=function(e,t){var n;return n=$(t.container)[t.attachWith||"append"],n(t.render().el)}}.call(this),function(){var e,t,n;Luca.CollectionManager=function(){function n(e){var n,r,i,s;this.options=e!=null?e:{},_.extend(this,this.options),r=this;if(n=typeof (i=Luca.CollectionManager).get=="function"?i.get(this.name):void 0)throw"Attempt to create a collection manager with a name which already exists";(s=Luca.CollectionManager).instances||(s.instances={}),_.extend(this,Backbone.Events),_.extend(this,Luca.Events),Luca.CollectionManager.instances[this.name]=r,Luca.CollectionManager.get=function(e){return e==null?r:Luca.CollectionManager.instances[e]},this.state=new Luca.Model,this.initialCollections&&t.call(this)}return n.prototype.name="primary",n.prototype.collectionNamespace=Luca.Collection.namespace,n.prototype.__collections={},n.prototype.relayEvents=!0,n.prototype.add=function(e,t){var n;return(n=this.currentScope())[e]||(n[e]=t)},n.prototype.allCollections=function(){return _(this.currentScope()).values()},n.prototype.create=function(t,n,r){var i,s,o;return n==null&&(n={}),r==null&&(r=[]),i=n.base,i||(i=e.call(this,t)),n.private&&(n.name=""),s=new i(r,n),this.add(t,s),o=this,this.relayEvents===!0&&this.bind("*",function(){return console.log("Relay Events on Collection Manager *",s,arguments)}),s},n.prototype.currentScope=function(){var e,t;return(e=this.getScope())?(t=this.__collections)[e]||(t[e]={}):this.__collections},n.prototype.each=function(e){return _(this.all()).each(e)},n.prototype.get=function(e){return this.currentScope()[e]},n.prototype.getScope=function(){return},n.prototype.destroy=function(e){var t;return t=this.get(e),delete this.currentScope()[e],t},n.prototype.getOrCreate=function(e,t,n){return t==null&&(t={}),n==null&&(n=[]),this.get(e)||this.create(e,t,n,!1)},n.prototype.collectionCountDidChange=function(){if(this.allCollectionsLoaded())return this.trigger("all_collections_loaded"),this.trigger("initial:load")},n.prototype.allCollectionsLoaded=function(){return this.totalCollectionsCount()===this.loadedCollectionsCount()},n.prototype.totalCollectionsCount=function(){return this.state.get("collections_count")},n.prototype.loadedCollectionsCount=function(){return this.state.get("loaded_collections_count")},n.prototype.private=function(e,t,n){return t==null&&(t={}),n==null&&(n=[]),this.create(e,t,n,!0)},n}(),Luca.CollectionManager.destroyAll=function(){return Luca.CollectionManager.instances={}},e=function(e){var t,n,r,i;return t=Luca.util.classify(e),n=(this.collectionNamespace||window||global)[t],n||(n=(this.collectionNamespace||window||global)[""+t+"Collection"]),n==null&&((i=Luca.Collection.namespaces)!=null?i.length:void 0)>0&&(r=_(Luca.Collection.namespaces.reverse()).map(function(e){return Luca.util.resolve(""+e+"."+t)||Luca.util.resolve(""+e+"."+t+"Collection")}),r=_(r).compact(),r.length>0&&(n=r[0])),n},n=function(){var e,t=this;return e=function(e){var n;return n=t.state.get("loaded_collections_count"),t.state.set("loaded_collections_count",n+1),t.trigger("collection_loaded",e.name),e.unbind("reset")},_(this.initialCollections).each(function(n){var r;return r=t.getOrCreate(n),r.once("reset",function(){return e(r)}),r.fetch()})},t=function(){var e=this;return this.state.set({loaded_collections_count:0,collections_count:this.initialCollections.length}),this.state.bind("change:loaded_collections_count",function(){return e.collectionCountDidChange()}),this.useProgressLoader&&(this.loaderView||(this.loaderView=new Luca.components.CollectionLoaderView({manager:this,name:"collection_loader_view"}))),n.call(this),this}}.call(this),function(){Luca.SocketManager=function(){function e(e){this.options=e!=null?e:{},_.extend(Backbone.Events),this.loadTransport()}return e.prototype.connect=function(){switch(this.options.provider){case"socket.io":return this.socket=io.connect(this.options.socket_host);case"faye.js":return this.socket=new Faye.Client(this.options.socket_host)}},e.prototype.transportLoaded=function(){return this.connect()},e.prototype.transport_script=function(){switch(this.options.provider){case"socket.io":return""+this.options.transport_host+"/socket.io/socket.io.js";case"faye.js":return""+this.options.transport_host+"/faye.js"}},e.prototype.loadTransport=function(){var e,t=this;return e=document.createElement("script"),e.setAttribute("type","text/javascript"),e.setAttribute("src",this.transport_script()),e.onload=this.transportLoaded,Luca.util.isIE()&&(e.onreadystatechange=function(){if(e.readyState==="loaded")return t.transportLoaded()}),document.getElementsByTagName("head")[0].appendChild(e)},e}()}.call(this),function(){_.def("Luca.containers.SplitView")["extends"]("Luca.core.Container")["with"]({componentType:"split_view",containerTemplate:"containers/basic",className:"luca-ui-split-view",componentClass:"luca-ui-panel"})}.call(this),function(){_.def("Luca.containers.ColumnView")["extends"]("Luca.core.Container")["with"]({componentType:"column_view",className:"luca-ui-column-view",components:[],initialize:function(e){return this.options=e!=null?e:{},console.log("Column Views are deprecated in favor of just using grid css on a normal container"),Luca.core.Container.prototype.initialize.apply(this,arguments),this.setColumnWidths()},componentClass:"luca-ui-column",containerTemplate:"containers/basic",generateComponentElements:!0,autoColumnWidths:function(){var e,t=this;return e=[],_(this.components.length).times(function(){return e.push(parseInt(100/t.components.length))}),e},setColumnWidths:function(){return this.columnWidths=this.layout!=null?_(this.layout.split("/")).map(function(e){return parseInt(e)}):this.autoColumnWidths(),this.columnWidths=_(this.columnWidths).map(function(e){return""+e+"%"})},beforeLayout:function(){var e,t=this;return this.debug("column_view before layout"),_(this.columnWidths).each(function(e,n){return t.components[n].float="left",t.components[n].width=e}),(e=Luca.core.Container.prototype.beforeLayout)!=null?e.apply(this,arguments):void 0}})}.call(this),function(){_.def("Luca.containers.CardView")["extends"]("Luca.core.Container")["with"]({componentType:"card_view",className:"luca-ui-card-view-wrapper",activeCard:0,components:[],hooks:["before:card:switch","after:card:switch"],componentClass:"luca-ui-card",generateComponentElements:!0,initialize:function(e){return this.options=e,Luca.core.Container.prototype.initialize.apply(this,arguments),this.setupHooks(this.hooks),this.components||(this.components=this.pages||(this.pages=this.cards))},prepareComponents:function(){var e,t=this;return(e=Luca.core.Container.prototype.prepareComponents)!=null&&e.apply(this,arguments),_(this.components).each(function(e,n){return n===t.activeCard?$(e.container).show():$(e.container).hide()})},activeComponentElement:function(){return this.componentElements().eq(this.activeCard)},activeComponent:function(){return this.getComponent(this.activeCard)},customizeContainerEl:function(e,t,n){return e.style+=n===this.activeCard?"display:block;":"display:none;",e},cycle:function(){var e;return e=this.activeCard<this.components.length-1?this.activeCard+1:0,this.activate(e)},find:function(e){return this.findComponentByName(e,!0)},firstActivation:function(){return this.activeComponent().trigger("first:activation",this,this.activeComponent())},activate:function(e,t,n){var r,i,s,o,u,a,f=this;t==null&&(t=!1),_.isFunction(t)&&(t=!1,n=t);if(e===this.activeCard)return;i=this.activeComponent(),r=this.getComponent(e),r||(e=this.indexOf(e),r=this.getComponent(e));if(!r)return;t||(this.trigger("before:card:switch",i,r),i!=null&&(s=i.trigger)!=null&&s.apply(i,["before:deactivation",this,i,r]),r!=null&&(o=r.trigger)!=null&&o.apply(i,["before:activation",this,i,r]),_.defer(function(){return f.$el.data(f.activeAttribute||"active-card",r.name)})),this.componentElements().hide(),r.previously_activated||(r.trigger("first:activation"),r.previously_activated=!0),this.activeCard=e,this.activeComponentElement().show(),t||(this.trigger("after:card:switch",i,r),(u=i.trigger)!=null&&u.apply(i,["deactivation",this,i,r]),(a=r.trigger)!=null&&a.apply(r,["activation",this,i,r]));if(_.isFunction(n))return n.apply(this,[this,i,r])}})}.call(this),function(){_.def("Luca.ModalView")["extends"]("Luca.core.Container")["with"]({closeOnEscape:!0,showOnInitialize:!1,backdrop:!1,className:"luca-ui-container modal",container:function(){return $("body")},toggle:function(){return this.$el.modal("toggle")},show:function(){return this.$el.modal("show")},hide:function(){return this.$el.modal("hide")},render:function(){return this.$el.addClass("modal"),this.fade===!0&&this.$el.addClass("fade"),$("body").append(this.$el),this.$el.modal({backdrop:this.backdrop===!0,keyboard:this.closeOnEscape===!0,show:this.showOnInitialize===!0}),this}}),_.def("Luca.containers.ModalView")["extends"]("Luca.ModalView")["with"]()}.call(this),function(){_.def("Luca.PageView")["extends"]("Luca.containers.CardView")["with"]({version:2})}.call(this),function(){var e,t,n;t=Backbone.View.prototype.make,e=function(e,r){var i,s,o,u,a,f,l,c,h,p,d=this;r==null&&(r=!0);if(e.ctype!=null){e.className||(e.className=""),e.className+="toolbar-component",c=Luca(e).render();if(Luca.isBackboneView(c))return console.log("Adding toolbar component",c),c.el}return e.spacer?t("div",{"class":"spacer "+e.spacer}):e.text?t("div",{"class":"toolbar-text"},e.text):(p="btn-group",e.wrapper!=null&&(p+=" "+e.wrapper),e.align!=null&&(p+=" align-"+e.align),e.group!=null&&e.buttons!=null?(u=n(e.buttons,!1),t("div",{"class":p},u)):(l=e.label||(e.label=""),e.eventId||(e.eventId=_.string.dasherize(e.label.toLowerCase())),e.icon&&(_.string.isBlank(l)&&(l=" "),e.white&&(h="icon-white"),l="<i class='"+(h||"")+" icon-"+e.icon+"' /> "+l),s={"class":_.compact(["btn",e.classes,e.className]).join(" "),"data-eventId":e.eventId,title:e.title||e.description},e.color!=null&&(s["class"]+=" btn-"+e.color),e.dropdown&&(l=""+l+" <span class='caret'></span>",s["class"]+=" dropdown-toggle",s["data-toggle"]="dropdown",f=_(e.dropdown).map(function(e){var n;return n=t("a",{},e[1]),t("li",{"data-eventId":e[0]},n)}),a=t("ul",{"class":"dropdown-menu"},f)),o=t("a",s,l),i="btn-group",e.align!=null&&(i+=" align-"+e.align),r===!0?t("div",{"class":i},[o,a]):o))},n=function(t,n){return n==null&&(n=!0),_(t).map(function(t){return e(t,n)})},_.def("Luca.containers.PanelToolbar")["extends"]("Luca.View")["with"]({className:"luca-ui-toolbar btn-toolbar",buttons:[],well:!0,orientation:"top",autoBindEventHandlers:!0,events:{"click a.btn, click .dropdown-menu li":"clickHandler"},clickHandler:function(e){var t,n,r,i,s;r=i=$(e.target),r.is("i")&&(r=i=$(e.target).parent()),t=i.data("eventid");if(t==null)return;return n=Luca.util.hook(t),s=this.parent||this,_.isFunction(s[n])?s[n].call(this,r,e):s.trigger(t,r,e)},beforeRender:function(){this._super("beforeRender",this,arguments),this.well===!0&&this.$el.addClass("well"),this.$el.addClass("toolbar-"+this.orientation);if(this.styles!=null)return this.applyStyles(this.styles)},render:function(){var e,t=this;return this.$el.empty(),e=n(this.buttons),_(e).each(function(e){return t.$el.append(e)})}})}.call(this),function(){_.def("Luca.containers.PanelView")["extends"]("Luca.core.Container")["with"]({className:"luca-ui-panel",initialize:function(e){return this.options=e!=null?e:{},Luca.core.Container.prototype.initialize.apply(this,arguments)},afterLayout:function(){var e;if(this.template)return e=(Luca.templates||JST)[this.template](this),this.$el.html(e)},render:function(){return $(this.container).append(this.$el)},afterRender:function(){var e,t=this;(e=Luca.core.Container.prototype.afterRender)!=null&&e.apply(this,arguments);if(this.css)return _(this.css).each(function(e,n){return t.$el.css(n,e)})}})}.call(this),function(){_.def("Luca.containers.TabView")["extends"]("Luca.containers.CardView")["with"]({hooks:["before:select","after:select"],componentType:"tab_view",className:"luca-ui-tab-view tabbable",tab_position:"top",tabVerticalOffset:"50px",navClass:"nav-tabs",bodyTemplate:"containers/tab_view",bodyEl:"div.tab-content",initialize:function(e){return this.options=e!=null?e:{},this.navStyle==="list"&&(this.navClass="nav-list"),Luca.containers.CardView.prototype.initialize.apply(this,arguments),_.bindAll(this,"select","highlightSelectedTab"),this.setupHooks(this.hooks),this.bind("after:card:switch",this.highlightSelectedTab)},activeTabSelector:function(){return this.tabSelectors().eq(this.activeCard||this.activeTab||this.activeItem)},beforeLayout:function(){var e;return this.$el.addClass("tabs-"+this.tab_position),this.activeTabSelector().addClass("active"),this.createTabSelectors(),(e=Luca.containers.CardView.prototype.beforeLayout)!=null?e.apply(this,arguments):void 0},afterRender:function(){var e,t;(t=Luca.containers.CardView.prototype.afterRender)!=null&&t.apply(this,arguments),e=this.tabContainer().attr("id"),this.registerEvent("click #"+e+" li a","select");if(Luca.enableBootstrap&&(this.tab_position==="left"||this.tab_position==="right"))return this.tabContainerWrapper().addClass("span2"),this.tabContentWrapper().addClass("span9")},createTabSelectors:function(){var e;return e=this,this.each(function(t,n){var r,i,s,o;t.tabIcon&&(r="<i class='icon-"+t.tabIcon+"'></i>"),i="<a href='#'>"+(r||"")+" "+t.title+"</a>",s=e.make("li",{"class":"tab-selector","data-target":n},i),e.tabContainer().append(s);if(t.navHeading!=null&&((o=e.navHeadings)!=null?!o[t.navHeading]:!void 0))return $(s).before(e.make("li",{"class":"nav-header"},t.navHeading)),e.navHeadings||(e.navHeadings={}),e.navHeadings[t.navHeading]=!0})},highlightSelectedTab:function(){return this.tabSelectors().removeClass("active"),this.activeTabSelector().addClass("active")},select:function(e){var t,n;return e.preventDefault(),t=n=$(e.target),this.trigger("before:select",this),this.activate(n.parent().data("target")),this.trigger("after:select",this)},componentElements:function(){return this.$(">.tab-content >."+this.componentClass)},tabContentWrapper:function(){return $("#"+this.cid+"-tab-view-content")},tabContainerWrapper:function(){return $("#"+this.cid+"-tabs-selector")},tabContainer:function(){return this.$("ul."+this.navClass,this.tabContainerWrapper())},tabSelectors:function(){return this.$("li.tab-selector",this.tabContainer())}})}.call(this),function(){_.def("Luca.containers.Viewport").extend("Luca.containers.CardView")["with"]({activeItem:0,additionalClassNames:"luca-ui-viewport",fullscreen:!0,fluid:!1,initialize:function(e){this.options=e!=null?e:{},_.extend(this,this.options),Luca.enableBootstrap===!0&&(this.wrapperClass=this.fluid===!0?Luca.containers.Viewport.fluidWrapperClass:Luca.containers.Viewport.defaultWrapperClass),Luca.core.Container.prototype.initialize.apply(this
,arguments);if(this.fullscreen===!0)return this.enableFullscreen()},enableFluid:function(){return this.enableWrapper()},disableFluid:function(){return this.disableWrapper()},enableWrapper:function(){if(this.wrapperClass!=null)return this.$el.parent().addClass(this.wrapperClass)},disableWrapper:function(){if(this.wrapperClass!=null)return this.$el.parent().removeClass(this.wrapperClass)},enableFullscreen:function(){return $("html,body").addClass("luca-ui-fullscreen"),this.$el.addClass("fullscreen-enabled")},disableFullscreen:function(){return $("html,body").removeClass("luca-ui-fullscreen"),this.$el.removeClass("fullscreen-enabled")},beforeRender:function(){var e;(e=Luca.containers.CardView.prototype.beforeRender)!=null&&e.apply(this,arguments),this.topNav!=null&&this.renderTopNavigation();if(this.bottomNav!=null)return this.renderBottomNavigation()},height:function(){return this.$el.height()},width:function(){return this.$el.width()},afterRender:function(){var e;(e=Luca.containers.CardView.prototype.after)!=null&&e.apply(this,arguments);if(Luca.enableBootstrap===!0&&this.containerClassName)return this.$el.children().wrap('<div class="#{ containerClassName }" />')},renderTopNavigation:function(){var e;if(this.topNav==null)return;return _.isString(this.topNav)&&(this.topNav=Luca.util.lazyComponent(this.topNav)),_.isObject(this.topNav)&&((e=this.topNav).ctype||(e.ctype=this.topNav.type||"nav_bar"),Luca.isBackboneView(this.topNav)||(this.topNav=Luca.util.lazyComponent(this.topNav))),this.topNav.app=this,$("body").prepend(this.topNav.render().el)},renderBottomNavigation:function(){}}),Luca.containers.Viewport.defaultWrapperClass="row",Luca.containers.Viewport.fluidWrapperClass="row-fluid"}.call(this),function(){_.def("Luca.components.Template")["extends"]("Luca.View")["with"]({initialize:function(e){return this.options=e!=null?e:{},console.log("The Use of Luca.components.Template directly is being DEPRECATED"),Luca.View.prototype.initialize.apply(this,arguments)}})}.call(this),function(){var e;e=function(){return Backbone.history.start()},_.def("Luca.Application")["extends"]("Luca.containers.Viewport")["with"]({name:"MyApp",defaultState:{},autoBoot:!1,autoStartHistory:"before:render",useCollectionManager:!0,collectionManager:{},collectionManagerClass:"Luca.CollectionManager",plugin:!1,useController:!0,useKeyHandler:!1,keyEvents:{},components:[{ctype:"template",name:"welcome",template:"sample/welcome",templateContainer:"Luca.templates"}],initialize:function(e){var t,n,r,i,s=this;this.options=e!=null?e:{},n=this,r=this.name,t=typeof Luca.getApplication=="function"?Luca.getApplication():void 0,(i=Luca.Application).instances||(i.instances={}),Luca.Application.instances[r]=n,Luca.containers.Viewport.prototype.initialize.apply(this,arguments),this.state=new Luca.Model(this.defaultState),this.useController===!0&&this.setupMainController(),this.setupCollectionManager(),this.defer(function(){return n.render()}).until(this,"ready"),this.setupRouter(),this.useKeyRouter===!0&&console.log("The useKeyRouter property is being deprecated. switch to useKeyHandler instead"),(this.useKeyHandler===!0||this.useKeyRouter===!0)&&this.keyEvents!=null&&this.setupKeyHandler(),this.plugin!==!0&&!t&&(Luca.getApplication=function(e){return e==null?n:Luca.Application.instances[e]});if(this.autoBoot){if(Luca.util.resolve(this.name))throw"Attempting to override window."+this.name+" when it already exists";return $(function(){return window[r]=n,n.boot()})}},activeView:function(){var e;return(e=this.activeSubSection())?this.view(e):this.view(this.activeSection())},activeSection:function(){return this.get("active_section")},activeSubSection:function(){return this.get("active_sub_section")},activePages:function(){var e=this;return this.$(".luca-ui-controller").map(function(e,t){return $(t).data("active-section")})},boot:function(){return this.trigger("ready")},collection:function(){return this.collectionManager.getOrCreate.apply(this.collectionManager,arguments)},get:function(e){return this.state.get(e)},set:function(e,t,n){return this.state.set.apply(this.state,arguments)},view:function(e){return Luca.cache(e)},navigate_to:function(e,t){return this.getMainController().navigate_to(e,t)},getMainController:function(){return this.useController===!0?this.components[0]:Luca.cache("main_controller")},keyHandler:function(e){var t,n,r,i,s,o,u;if(!e||!this.keyEvents)return;n=$(e.target).is("input")||$(e.target).is("textarea");if(n)return;i=Luca.keyMap[e.keyCode];if(!i)return;s=(e!=null?e.metaKey:void 0)===!0,t=(e!=null?e.ctrlKey:void 0)===!0,o=this.keyEvents,o=s?this.keyEvents.meta:o,o=t?this.keyEvents.control:o,o=s&&t?this.keyEvents.meta_control:o;if(r=o!=null?o[i]:void 0)return this[r]!=null&&_.isFunction(this[r])?(u=this[r])!=null?u.call(this):void 0:this.trigger(r,e,i)},setupControllerBindings:function(){var e,t,n,r=this;return e=this,(t=this.getMainController())!=null&&t.bind("after:card:switch",function(t,n){return r.state.set({active_section:n.name}),e.trigger("page:change")}),(n=this.getMainController())!=null?n.each(function(t){if(t.ctype.match(/controller$/))return t.bind("after:card:switch",function(t,n){return r.state.set({active_sub_section:n.name}),e.trigger("sub:page:change")})}):void 0},setupMainController:function(){var e;if(this.useController===!0)return e=this.components||[],this.components=[{ctype:"controller",name:"main_controller",components:e}],this.defer(this.setupControllerBindings,!1).until("after:components")},setupCollectionManager:function(){var e,t,n,r;if(this.useCollectionManager===!0){_.isString(this.collectionManagerClass)&&(this.collectionManagerClass=Luca.util.resolve(this.collectionManagerClass)),e=this.collectionManagerOptions,_.isObject(this.collectionManager)&&!_.isFunction((n=this.collectionManager)!=null?n.get:void 0)&&(e=this.collectionManager,this.collectionManager=void 0),_.isString(this.collectionManager)&&(e={name:this.collectionManager}),this.collectionManager=typeof (t=Luca.CollectionManager).get=="function"?t.get(e.name):void 0;if(!_.isFunction((r=this.collectionManager)!=null?r.get:void 0))return this.collectionManager=new this.collectionManagerClass(e)}},setupRouter:function(){var t,n;t=this,_.isString(this.router)&&(n=Luca.util.resolve(this.router),this.router=new n({app:t}));if(this.router&&this.autoStartHistory)return this.autoStartHistory===!0&&(this.autoStartHistory="before:render"),this.defer(e,!1).until(this,this.autoStartHistory)},setupKeyHandler:function(){var e,t,n,r,i,s,o;if(!this.keyEvents)return;(n=this.keyEvents).control_meta||(n.control_meta={}),this.keyEvents.meta_control&&_.extend(this.keyEvents.control_meta,this.keyEvents.meta_control),e=_.bind(this.keyHandler,this),s=this.keypressEvents||["keydown"],o=[];for(r=0,i=s.length;r<i;r++)t=s[r],o.push($(document).on(t,e));return o}})}.call(this),function(){_.def("Luca.components.Toolbar")["extends"]("Luca.core.Container")["with"]({className:"luca-ui-toolbar toolbar",position:"bottom",initialize:function(e){return this.options=e!=null?e:{},Luca.core.Container.prototype.initialize.apply(this,arguments)},prepareComponents:function(){var e=this;return _(this.components).each(function(t){return t.container=e.$el})},render:function(){return $(this.container).append(this.el)}})}.call(this),function(){_.def("Luca.components.CollectionLoaderView")["extends"]("Luca.components.Template")["with"]({className:"luca-ui-collection-loader-view",template:"components/collection_loader_view",initialize:function(e){return this.options=e!=null?e:{},Luca.components.Template.prototype.initialize.apply(this,arguments),this.container||(this.container=$("body")),this.manager||(this.manager=Luca.CollectionManager.get()),this.setupBindings()},modalContainer:function(){return $("#progress-modal",this.el)},setupBindings:function(){var e=this;return this.manager.bind("collection_loaded",function(t){var n,r,i,s;return r=e.manager.loadedCollectionsCount(),s=e.manager.totalCollectionsCount(),i=parseInt(r/s*100),n=_.string.titleize(_.string.humanize(t)),e.modalContainer().find(".progress .bar").attr("style","width: "+i+"%;"),e.modalContainer().find(".message").html("Loaded "+n+"...")}),this.manager.bind("all_collections_loaded",function(){return e.modalContainer().find(".message").html("All done!"),_.delay(function(){return e.modalContainer().modal("hide")},400)})}})}.call(this),function(){var e,t;_.def("Luca.components.CollectionView")["extends"]("Luca.components.Panel")["with"]({mixins:["LoadMaskable","FilterableView"],tagName:"div",className:"luca-ui-collection-view",bodyClassName:"collection-ui-panel",itemTemplate:void 0,itemRenderer:void 0,itemTagName:"li",itemClassName:"collection-item",hooks:["empty:results"],initialize:function(e){var n=this;this.options=e!=null?e:{},_.extend(this,this.options),_.bindAll(this,"refresh");if(this.collection==null&&!this.options.collection)throw"Collection Views must specify a collection";if(this.itemTemplate==null&&this.itemRenderer==null&&this.itemProperty==null)throw"Collection Views must specify an item template or item renderer function";Luca.components.Panel.prototype.initialize.apply(this,arguments),_.isString(this.collection)&&Luca.CollectionManager.get()&&(this.collection=Luca.CollectionManager.get().getOrCreate(this.collection));if(!Luca.isBackboneCollection(this.collection))throw"Collection Views must have a valid backbone collection";return this.collection.on("before:fetch",function(){if(n.loadMask===!0)return n.trigger("enable:loadmask")}),this.collection.bind("reset",function(){return n.loadMask===!0&&n.trigger("disable:loadmask"),n.refresh()}),this.collection.bind("add",this.refresh),this.collection.bind("remove",this.refresh),this.observeChanges===!0&&t.call(this),this.defer(function(){if(n.collection.length>0)return n.refresh()}).until("after:render")},attributesForItem:function(e,t){return _.extend({},{"class":this.itemClassName,"data-index":e.index,"data-model-id":e.model.get("id")})},contentForItem:function(e){var t,n;return e==null&&(e={}),this.itemTemplate!=null&&(n=Luca.template(this.itemTemplate))&&(t=n.call(this,e)),this.itemRenderer!=null&&_.isFunction(this.itemRenderer)&&(t=this.itemRenderer.call(this,e,e.model,e.index)),this.itemProperty&&(t=e.model.get(this.itemProperty)||e.model[this.itemProperty],_.isFunction(t)&&(t=t())),t},makeItem:function(t,n){var r,i,s;s=this.prepareItem!=null?this.prepareItem.call(this,t,n):{model:t,index:n},r=this.attributesForItem(s,t),i=this.contentForItem(s);try{return e(this.itemTagName,r,i)}catch(o){return console.log("Error generating DOM element for CollectionView",o.message,s,i,r)}},getModels:function(e,t){var n;return e==null&&(e=this.filter),t==null&&(t=this.filterOptions),((n=this.collection)!=null?n.query:void 0)?this.collection.query(e||{},t||{}):this.collection.models},locateItemElement:function(e){return this.$("."+this.itemClassName+"[data-model-id='"+e+"']")},refreshModel:function(e){var t;return t=this.collection.indexOf(e),this.locateItemElement(e.get("id")).empty().append(this.contentForItem({model:e,index:t},e))},refresh:function(e,t){var n,r,i,s,o;this.trigger("before:refresh"),this.$bodyEl().empty(),i=this.getModels(e,t),i.length===0&&this.trigger("empty:results"),n=0;for(s=0,o=i.length;s<o;s++)r=i[s],this.$append(this.makeItem(r,n++));return this.trigger("after:refresh"),this},registerEvent:function(e,t,n){var r;return n==null&&_.isFunction(t)&&(n=t,t=void 0),r=_([e,""+this.itemTagName+"."+this.itemClassName,t]).compact().join(" "),Luca.View.prototype.registerEvent(r,n)},render:function(){return this.refresh(),this.$el.parent().length>0&&this.container!=null&&this.$attach(),this}}),e=Luca.View.prototype.make,t=function(){var e=this;return this.collection.on("change",function(t){return e.refreshModel(t)})}}.call(this),function(){_.def("Luca.components.Controller")["extends"]("Luca.containers.CardView")["with"]({additionalClassNames:["luca-ui-controller"],activeAttribute:"active-section",initialize:function(e){var t;this.options=e,Luca.containers.CardView.prototype.initialize.apply(this,arguments),this.defaultCard||(this.defaultCard=(t=this.components[0])!=null?t.name:void 0);if(!this.defaultCard)throw"Controllers must specify a defaultCard property and/or the first component must have a name";return this.state=new Backbone.Model({active_section:this.defaultCard})},each:function(e){var t=this;return _(this.components).each(function(n){return e.apply(t,[n])})},activeSection:function(){return this.get("activeSection")},controllers:function(e){return e==null&&(e=!1),this.select("ctype","controller",e)},availableSections:function(){var e,t=this;return e={},e[this.name]=this.sectionNames(),_(this.controllers()).reduce(function(e,t){return e[t.name]=t.sectionNames(),e},e)},sectionNames:function(e){return e==null&&(e=!1),this.pluck("name")},"default":function(e){return this.navigate_to(this.defaultCard,e)},navigate_to:function(e,t){var n=this;return e||(e=this.defaultCard),this.activate(e,!1,function(e,r,i){n.state.set({active_section:i.name});if(_.isFunction(t))return t.apply(i)}),this.find(e)}})}.call(this),function(){_.def("Luca.fields.ButtonField")["extends"]("Luca.core.Field")["with"]({readOnly:!0,events:{"click input":"click_handler"},hooks:["button:click"],className:"luca-ui-field luca-ui-button-field",template:"fields/button_field",click_handler:function(e){var t,n;return t=n=$(e.currentTarget),this.trigger("button:click")},initialize:function(e){var t;this.options=e!=null?e:{},_.extend(this.options),_.bindAll(this,"click_handler"),Luca.core.Field.prototype.initialize.apply(this,arguments);if((t=this.icon_class)!=null?t.length:void 0)return this.template="fields/button_field_link"},afterInitialize:function(){this.input_id||(this.input_id=_.uniqueId("button")),this.input_name||(this.input_name=this.name||(this.name=this.input_id)),this.input_value||(this.input_value=this.label||(this.label=this.text)),this.input_type||(this.input_type="button"),this.input_class||(this.input_class=this["class"]),this.icon_class||(this.icon_class=""),this.icon_class.length&&!this.icon_class.match(/^icon-/)&&(this.icon_class="icon-"+this.icon_class);if(this.white)return this.icon_class+=" icon-white"},setValue:function(){return!0}})}.call(this),function(){var e;e=Luca.View.prototype.make,_.def("Luca.fields.CheckboxArray")["extends"]("Luca.core.Field")["with"]({version:2,template:"fields/checkbox_array",className:"luca-ui-checkbox-array",events:{"click input":"clickHandler"},selectedItems:[],initialize:function(e){return this.options=e!=null?e:{},_.extend(this,this.options),_.extend(this,Luca.modules.Deferrable),_.bindAll(this,"renderCheckboxes","clickHandler","checkSelected"),Luca.core.Field.prototype.initialize.apply(this,arguments),this.input_id||(this.input_id=_.uniqueId("field")),this.input_name||(this.input_name=this.name),this.label||(this.label=this.name),this.valueField||(this.valueField="id"),this.displayField||(this.displayField="name")},afterInitialize:function(e){var t;this.options=e!=null?e:{};try{this.configure_collection()}catch(n){console.log("Error Configuring Collection",this,n.message)}return t=this,this.collection.length>0?this.renderCheckboxes():this.defer("renderCheckboxes").until(this.collection,"reset")},clickHandler:function(e){var t;t=$(e.target);if(t.prop("checked"))return this.selectedItems.push(t.val());if(_(this.selectedItems).include(t.val()))return this.selectedItems=_(this.selectedItems).without(t.val())},controls:function(){return this.$(".controls")},renderCheckboxes:function(){var t=this;return this.controls().empty(),this.selectedItems=[],this.collection.each(function(n){var r,i,s,o,u;return u=n.get(t.valueField),o=n.get(t.displayField),s=_.uniqueId(""+t.cid+"_checkbox"),i=e("input",{type:"checkbox","class":"array-checkbox",name:t.input_name,value:u,id:s}),r=e("label",{"for":s},i),$(r).append(" "+o),t.controls().append(r)}),this.trigger("checkboxes:rendered",this.checkboxesRendered=!0),this},uncheckAll:function(){return this.allFields().prop("checked",!1)},allFields:function(){return this.controls().find("input[type='checkbox']")},checkSelected:function(e){var t,n,r,i,s;e!=null&&(this.selectedItems=e),this.uncheckAll(),s=this.selectedItems;for(r=0,i=s.length;r<i;r++)n=s[r],t=this.controls().find("input[value='"+n+"']"),t.prop("checked",!0);return this.selectedItems},getValue:function(){var e,t,n,r,i;r=this.allFields(),i=[];for(t=0,n=r.length;t<n;t++)e=r[t],this.$(e).prop("checked")&&i.push(this.$(e).val());return i},setValue:function(e){var t;return this.selectedItems=e,this.checkboxesRendered===!0?this.checkSelected(e):(t=this,this.defer(function(){return t.checkSelected(e)}).until("checkboxes:rendered"))},getValues:function(){return this.getValue()},setValues:function(e){return this.setValue(e)}})}.call(this),function(){_.def("Luca.fields.CheckboxField")["extends"]("Luca.core.Field")["with"]({events:{"change input":"change_handler"},className:"luca-ui-checkbox-field luca-ui-field",template:"fields/checkbox_field",hooks:["checked","unchecked"],send_blanks:!0,change_handler:function(e){var t,n;return t=n=$(e.target),t.is(":checked")?this.trigger("checked"):this.trigger("unchecked"),this.trigger("on:change",this,e,t.is(":checked"))},initialize:function(e){return this.options=e!=null?e:{},_.extend(this,this.options),_.bindAll(this,"change_handler"),Luca.core.Field.prototype.initialize.apply(this,arguments)},afterInitialize:function(){return this.input_id||(this.input_id=_.uniqueId("field")),this.input_name||(this.input_name=this.name),this.input_value||(this.input_value=1),this.label||(this.label=this.name)},setValue:function(e){return this.input.attr("checked",e)},getValue:function(){return this.input.is(":checked")}})}.call(this),function(){_.def("Luca.fields.FileUploadField")["extends"]("Luca.core.Field")["with"]({template:"fields/file_upload_field",initialize:function(e){return this.options=e!=null?e:{},Luca.core.Field.prototype.initialize.apply(this,arguments)},afterInitialize:function(){return this.input_id||(this.input_id=_.uniqueId("field")),this.input_name||(this.input_name=this.name),this.label||(this.label=this.name),this.helperText||(this.helperText="")}})}.call(this),function(){_.def("Luca.fields.HiddenField")["extends"]("Luca.core.Field")["with"]({template:"fields/hidden_field",initialize:function(e){return this.options=e!=null?e:{},Luca.core.Field.prototype.initialize.apply(this,arguments)},afterInitialize:function(){return this.input_id||(this.input_id=_.uniqueId("field")),this.input_name||(this.input_name=this.name),this.input_value||(this.input_value=this.value),this.label||(this.label=this.name)}})}.call(this),function(){_.def("Luca.components.LabelField")["extends"]("Luca.core.Field")["with"]({className:"luca-ui-field luca-ui-label-field",getValue:function(){return this.$("input").attr("value")},formatter:function(e){return e||(e=this.getValue()),_.str.titleize(e)},setValue:function(e){return this.trigger("change",e,this.getValue()),this.$("input").attr("value",e),this.$(".value").html(this.formatter(e))}})}.call(this),function(){_.def("Luca.fields.SelectField")["extends"]("Luca.core.Field")["with"]({events:{"change select":"change_handler"},hooks:["after:select"],className:"luca-ui-select-field luca-ui-field",template:"fields/select_field",includeBlank:!0,blankValue:"",blankText:"Select One",initialize:function(e){this.options=e!=null?e:{},_.extend(this,this.options),_.extend(this,Luca.modules.Deferrable),_.bindAll(this,"change_handler","populateOptions","beforeFetch"),Luca.core.Field.prototype.initialize.apply(this,arguments),this.input_id||(this.input_id=_.uniqueId("field")),this.input_name||(this.input_name=this.name),this.label||(this.label=this.name);if(_.isUndefined(this.retainValue))return this.retainValue=!0},afterInitialize:function(){var e;if((e=this.collection)!=null?e.data:void 0)this.valueField||(this.valueField="id"),this.displayField||(this.displayField="name"),this.parseData();try{this.configure_collection()}catch(t){console.log("Error Configuring Collection",this,t.message)}return this.collection.bind("before:fetch",this.beforeFetch),this.collection.bind("reset",this.populateOptions)},parseData:function(){var e=this;return this.collection.data=_(this.collection.data).map(function(t){var n;return _.isArray(t)?(n={},n[e.valueField]=t[0],n[e.displayField]=t[1]||t[0],n):t})},afterRender:function(){var e,t;return this.input=$("select",this.el),((e=this.collection)!=null?(t=e.models)!=null?t.length:void 0:void 0)>0?this.populateOptions():this.collection.trigger("reset")},setValue:function(e){return this.currentValue=e,Luca.core.Field.prototype.setValue.apply(this,arguments)},beforeFetch:function(){return this.resetOptions()},change_handler:function(e){return this.trigger("on:change",this,e)},resetOptions:function(){this.input.html("");if(this.includeBlank)return this.input.append("<option value='"+this.blankValue+"'>"+this.blankText+"</option>")},populateOptions:function(){var e,t=this;return this.resetOptions(),((e=this.collection)!=null?e.each:void 0)!=null&&this.collection.each(function(e){var n,r,i,s;return s=e.get(t.valueField),n=e.get(t.displayField),t.selected&&s===t.selected&&(i="selected"),r="<option "+i+" value='"+s+"'>"+n+"</option>",t.input.append(r)}),this.trigger("after:populate:options",this),this.setValue(this.currentValue)}})}.call(this),function(){_.def("Luca.fields.TextAreaField")["extends"]("Luca.core.Field")["with"]({events:{"keydown input":"keydown_handler","blur input":"blur_handler","focus input":"focus_handler"},template:"fields/text_area_field",height:"200px",width:"90%",initialize:function(e){return this.options=e!=null?e:{},_.bindAll(this,"keydown_handler"),Luca.core.Field.prototype.initialize.apply(this,arguments),this.input_id||(this.input_id=_.uniqueId("field")),this.input_name||(this.input_name=this.name),this.label||(this.label=this.name),this.input_class||(this.input_class=this["class"]),this.inputStyles||(this.inputStyles="height:"+this.height+";width:"+this.width)},setValue:function(e){return $(this.field()).val(e)},getValue:function(){return $(this.field()).val()},field:function(){return this.input=$("textarea#"+this.input_id,this.el)},keydown_handler:function(e){var t,n;return t=n=$(e.currentTarget)},blur_handler:function(e){var t,n;return t=n=$(e.currentTarget)},focus_handler:function(e){var t,n;return t=n=$(e.currentTarget)}})}.call(this),function(){_.def("Luca.fields.TextField")["extends"]("Luca.core.Field")["with"]({events:{"blur input":"blur_handler","focus input":"focus_handler","change input":"change_handler"},template:"fields/text_field",autoBindEventHandlers:!0,send_blanks:!0,keyEventThrottle:300,initialize:function(e){return this.options=e!=null?e:{},this.enableKeyEvents&&this.registerEvent("keyup input","keyup_handler"),this.input_id||(this.input_id=_.uniqueId("field")),this.input_name||(this.input_name=this.name),this.label||(this.label=this.name),this.input_class||(this.input_class=this["class"]),this.prepend&&(this.$el.addClass("input-prepend"),this.addOn=this.prepend),this.append&&(this.$el.addClass("input-append"),this.addOn=this.append),Luca.core.Field.prototype.initialize.apply(this,arguments)},keyup_handler:function(e){return this.trigger("on:keyup",this,e)},blur_handler:function(e){return this.trigger("on:blur",this,e)},focus_handler:function(e){return this.trigger("on:focus",this,e)},change_handler:function(e){return this.trigger("on:change",this,e)}})}.call(this),function(){_.def("Luca.fields.TypeAheadField")["extends"]("Luca.fields.TextField")["with"]({className:"luca-ui-field",getSource:function(){return _.isFunction(this.source)?this.source.call(this):this.source||[]},matcher:function(e){return!0},beforeRender:function(){return this._super("beforeRender",this,arguments),this.$("input").attr("data-provide","typeahead")},afterRender:function(){return this._super("afterRender",this,arguments),this.$("input").typeahead({matcher:this.matcher,source:this.getSource()})}})}.call(this),function(){_.def("Luca.components.FormButtonToolbar")["extends"]("Luca.components.Toolbar")["with"]({className:"luca-ui-form-toolbar form-actions",position:"bottom",includeReset:!1,render:function(){return $(this.container).append(this.el)},initialize:function(e){this.options=e!=null?e:{},Luca.components.Toolbar.prototype.initialize.apply(this,arguments),this.components=[{ctype:"button_field",label:"Submit","class":"btn submit-button"}];if(this.includeReset)return this.components.push({ctype:"button_field",label:"Reset","class":"btn reset-button"})}})}.call(this),function(){var e;e={buttons:[{icon:"remove-sign",label:"Reset",eventId:"click:reset",className:"reset-button",align:"right"},{icon:"ok-sign",white:!0,label:"Save Changes",eventId:"click:submit",color:"success",className:"submit-button",align:"right"}]},_.def("Luca.components.FormView")["extends"]("Luca.core.Container")["with"]({tagName:"form",className:"luca-ui-form-view",hooks:["before:submit","before:reset","before:load","before:load:new","before:load:existing","after:submit","after:reset","after:load","after:load:new","after:load:existing","after:submit:success","after:submit:fatal_error","after:submit:error"],events:{"click .submit-button":"submitHandler","click .reset-button":"resetHandler"},toolbar:!0,legend:"",bodyClassName:"form-view-body",version:"0.9.33333333",initialize:function(e){this.options=e!=null?e:{},this.loadMask==null&&(this.loadMask=Luca.enableBootstrap),Luca.core.Container.prototype.initialize.apply(this,arguments),this.components||(this.components=this.fields),_.bindAll(this,"submitHandler","resetHandler","renderToolbars","applyLoadMask"),this.state||(this.state=new Backbone.Model),this.setupHooks(this.hooks),this.applyStyleClasses();if(this.toolbar!==!1&&!this.topToolbar&&!this.bottomToolbar){if(this.toolbar==="both"||this.toolbar==="top")this.topToolbar=this.getDefaultToolbar();if(this.toolbar!=="top")return this.bottomToolbar=this.getDefaultToolbar()}},getDefaultToolbar:function(){return e},applyStyleClasses:function(){Luca.enableBootstrap&&this.applyBootstrapStyleClasses(),this.labelAlign&&this.$el.addClass("label-align-"+this.labelAlign);if(this.fieldLayoutClass)return this.$el.addClass(this.fieldLayoutClass)},applyBootstrapStyleClasses:function(){this.labelAlign==="left"&&(this.inlineForm=!0),this.well&&this.$el.addClass("well"),this.searchForm&&this.$el.addClass("form-search"),this.horizontalForm&&this.$el.addClass("form-horizontal");if(this.inlineForm)return this.$el.addClass("form-inline")},resetHandler:function(e){var t,n;return t=n=$(e!=null?e.target:void 0),this.trigger("before:reset",this),this.reset(),this.trigger("after:reset",this)},submitHandler:function(e){var t,n;t=n=$(e!=null?e.target:void 0),this.trigger("before:submit",this),this.loadMask===!0&&this.trigger("enable:loadmask",this);if(this.hasModel())return this.submit()},afterComponents:function(){var e,t=this;return(e=Luca.core.Container.prototype.afterComponents)!=null&&e.apply(this,arguments),this.eachField(function(e){return e.getForm=function(){return t},e.getModel=function(){return t.currentModel()}})},eachField:function(e){return _(this.getFields()).map(e)},getField:function(e){var t;return t=_(this.getFields("name",e)).first(),t!=null?t:_(this.getFields("input_name",e)).first()},getFields:function(e,t){var n;return n=this.selectByAttribute("isField",!0,!0),e!=null&&t!=null&&(n=_(n).select(function(n){var r;return r=n[e],_.isFunction(r)&&(r=r.call(n)),r===t})),n},loadModel:function(e){var t,n,r,i;this.current_model=e,r=this,n=this.getFields(),this.trigger("before:load",this,this.current_model),this.current_model&&((i=this.current_model.beforeFormLoad)!=null&&i.apply(this.current_model,this),t="before:load:"+(this.current_model.isNew()?"new":"existing"),this.trigger(t,this,this.current_model)),this.setValues(this.current_model),this.trigger("after:load",this,this.current_model);if(this.current_model)return this.trigger("after:load:"+(this.current_model.isNew()?"new":"existing"),this,this.current_model)},reset:function(){if(this.current_model!=null)return this.loadModel(this.current_model)},clear:function(){var e=this;return this.current_model=this.defaultModel!=null?this.defaultModel():void 0,_(this.getFields()).each(function(t){try{return t.setValue("")}catch(n){return console.log("Error Clearing",e,t)}})},setValues:function(e,t){var n,r=this;t==null&&(t={}),e||(e=this.currentModel()),n=this.getFields(),_(n).each(function(t){var n,i;n=t.input_name||t.name,(i=e[n])&&_.isFunction(i)&&(i=i.apply(r)),!i&&Luca.isBackboneModel(e)&&(i=e.get(n));if(t.readOnly!==!0)return t!=null?t.setValue(i):void 0});if(t.silent!=null!=1)return this.syncFormWithModel()},getValues:function(e){var t,n=this;return e==null&&(e={}),e.reject_blank==null&&(e.reject_blank=!0),e.skip_buttons==null&&(e.skip_buttons=!0),e.blanks===!1&&(e.reject_blank=!0),t=_(this.getFields()).inject(function(t,n){var r,i,s,o,u;return o=n.getValue(),i=n.input_name||n.name,u=!!_.str.isBlank(o)||!!_.isUndefined(o),r=!e.reject_blank&&!n.send_blanks,e.debug&&console.log(""+i+" Options",e,"Value",o,"Value Is Blank?",u,"Allow Blanks?",r),e.skip_buttons&&n.ctype==="button_field"?s=!0:(u&&r===!1&&(s=!0),n.input_name==="id"&&u===!0&&(s=!0)),e.debug&&console.log("Skip is true on "+i),s!==!0&&(t[i]=o),t},e.defaults||{}),t},submit_success_handler:function(e,t,n){return this.trigger("after:submit",this,e,t),this.loadMask===!0&&this.trigger("disable:loadmask",this),t&&(t!=null?t.success:void 0)===!0?this.trigger("after:submit:success",this,e,t):this.trigger("after:submit:error",this,e,t)},submit_fatal_error_handler:function(e,t,n){return this.trigger("after:submit",this,e,t),this.trigger("after:submit:fatal_error",this,e,t)},submit:function(e,t){e==null&&(e=!0),t==null&&(t={}),_.bindAll(this,"submit_success_handler","submit_fatal_error_handler"),t.success||(t.success=this.submit_success_handler),t.error||(t.error=this.submit_fatal_error_handler),this.syncFormWithModel();if(!e)return;return this.current_model.save(this.current_model.toJSON(),t)},hasModel:function(){return this.current_model!=null},currentModel:function(e){return e==null&&(e={}),(e===!0||(e!=null?e.refresh:void 0)===!0)&&this.syncFormWithModel(),this.current_model},syncFormWithModel:function(){var e;return(e=this.current_model)!=null?e.set(this.getValues()):void 0},setLegend:function(e){return this.legend=e,$("fieldset legend",this.el).first().html(this.legend)},flash:function(e){return this.$(".toolbar-container.top").length>0?this.$(".toolbar-container.top").after(e):this.$bodyEl().prepend(e)},successFlashDelay:1500,successMessage:function(e){var t=this;return this.$(".alert.alert-success").remove(),this.flash(Luca.template("components/form_alert",{className:"alert alert-success",message:e})),_.delay(function(){return t.$(".alert.alert-success").fadeOut()},this.successFlashDelay||0)},errorMessage:function(e){return this.$(".alert.alert-error").remove(),this.flash(Luca.template("components/form_alert",{className:"alert alert-error",message:e}))}})}.call(this),function(){_.def("Luca.components.GridView").extend("Luca.components.Panel")["with"]({bodyTemplate:"components/grid_view",autoBindEventHandlers:!0,events:{"dblclick table tbody tr":"double_click_handler","click table tbody tr":"click_handler"},className:"luca-ui-g-view",rowClass:"luca-ui-g-row",wrapperClass:"luca-ui-g-view-wrapper",additionalWrapperClasses:[],wrapperStyles:{},scrollable:!0,emptyText:"No Results To display.",tableStyle:"striped",defaultHeight:285,defaultWidth:756,maxWidth:void 0,hooks:["before:grid:render","before:render:header","before:render:row","after:grid:render","row:double:click","row:click","after:collection:load"],initialize:function(e){var t=this;return this.options=e!=null?e:{},_.extend(this,this.options),_.extend(this,Luca.modules.Deferrable),this.loadMask==null&&(this.loadMask=Luca.enableBootstrap),this.loadMask===!0&&(this.loadMaskEl||(this.loadMaskEl=".luca-ui-g-view-body")),Luca.components.Panel.prototype.initialize.apply(this,arguments),this.configure_collection(!0),this.collection.bind("before:fetch",function(){if(t.loadMask===!0)return t.trigger("enable:loadmask")}),this.collection.bind("reset",function(e){return t.refresh(),t.loadMask===!0&&t.trigger("disable:loadmask"),t.trigger("after:collection:load",e)}),this.collection.bind("change",function(e){var n,r;if(t.rendered!==!0)return;try{return r=t.getRowEl(e.id||e.get("id")||e.cid),n=t.render_row(e,t.collection.indexOf(e),{cellsOnly:!0}),$(r).html(n.join(" "))}catch(i){return console.log("Error in change handler for GridView.collection",i,t,e)}})},beforeRender:function(){var e;return(e=Luca.components.Panel.prototype.beforeRender)!=null&&e.apply(this,arguments),this.trigger("before:grid:render",this),this.table=
this.$("table.luca-ui-g-view"),this.header=this.$("thead"),this.body=this.$("tbody"),this.footer=this.$("tfoot"),this.wrapper=this.$("."+this.wrapperClass),this.applyCssClasses(),this.scrollable&&this.setDimensions(),this.renderHeader(),this.emptyMessage(),$(this.container).append(this.$el)},afterRender:function(){var e;return(e=Luca.components.Panel.prototype.afterRender)!=null&&e.apply(this,arguments),this.rendered=!0,this.refresh(),this.trigger("after:grid:render",this)},applyCssClasses:function(){var e,t=this;return this.scrollable&&this.$el.addClass("scrollable-g-view"),_(this.additionalWrapperClasses).each(function(e){var n;return(n=t.wrapper)!=null?n.addClass(e):void 0}),Luca.enableBootstrap&&this.table.addClass("table"),_((e=this.tableStyle)!=null?e.split(" "):void 0).each(function(e){return t.table.addClass("table-"+e)})},setDimensions:function(e){var t=this;return this.height||(this.height=this.defaultHeight),this.$(".luca-ui-g-view-body").height(this.height),this.$("tbody.scrollable").height(this.height-23),this.container_width=function(){return $(t.container).width()}(),this.width||(this.width=this.container_width>0?this.container_width:this.defaultWidth),this.width=_([this.width,this.maxWidth||this.width]).max(),this.$(".luca-ui-g-view-body").width(this.width),this.$(".luca-ui-g-view-body table").width(this.width),this.setDefaultColumnWidths()},resize:function(e){var t,n,r=this;t=e-this.width,this.width=e,this.$(".luca-ui-g-view-body").width(this.width),this.$(".luca-ui-g-view-body table").width(this.width);if(this.columns.length>0)return n=t/this.columns.length,_(this.columns).each(function(e,t){var i;return i=$(".column-"+t,r.el),i.width(e.width=e.width+n)})},padLastColumn:function(){var e,t;e=_(this.columns).inject(function(e,t){return e=t.width+e},0),t=this.width-e;if(t>0)return this.lastColumn().width+=t},setDefaultColumnWidths:function(){var e;return e=this.columns.length>0?this.width/this.columns.length:200,_(this.columns).each(function(t){return parseInt(t.width||(t.width=e))}),this.padLastColumn()},lastColumn:function(){return this.columns[this.columns.length-1]},emptyMessage:function(e){return e==null&&(e=""),e||(e=this.emptyText),this.body.html(""),this.body.append(Luca.templates["components/grid_view_empty_text"]({colspan:this.columns.length,text:e}))},refresh:function(){var e=this;this.body.html(""),this.collection.each(function(t,n){return e.render_row.apply(e,[t,n])});if(this.collection.models.length===0)return this.emptyMessage()},ifLoaded:function(e,t){return t||(t=this),e||(e=function(){return!0}),this.collection.ifLoaded(e,t)},applyFilter:function(e,t){return t==null&&(t={auto:!0,refresh:!0}),this.collection.applyFilter(e,t)},renderHeader:function(){var e,t=this;return this.trigger("before:render:header"),e=_(this.columns).map(function(e,t){var n;return n=e.width?"width:"+e.width+"px;":"","<th style='"+n+"' class='column-"+t+"'>"+e.header+"</th>"}),this.header.append("<tr>"+e+"</tr>")},getRowEl:function(e){return this.$("[data-record-id="+e+"]","table")},render_row:function(e,t,n){var r,i,s,o,u,a,f=this;return n==null&&(n={}),u=this.rowClass,o=(e!=null?e.get:void 0)&&(e!=null?e.attributes:void 0)?e.get("id"):"",this.trigger("before:render:row",e,t),i=_(this.columns).map(function(t,n){var r,i,s;return s=f.cell_renderer(e,t,n),i=t.width?"width:"+t.width+"px;":"",r=_.isUndefined(s)?"":s,"<td style='"+i+"' class='column-"+n+"'>"+r+"</td>"}),n.cellsOnly?i:(r="",this.alternateRowClasses&&(r=t%2===0?"even":"odd"),s="<tr data-record-id='"+o+"' data-row-index='"+t+"' class='"+u+" "+r+"' id='row-"+t+"'>"+i+"</tr>",n.contentOnly===!0?s:(a=this.body)!=null?a.append(s):void 0)},cell_renderer:function(e,t,n){var r;return _.isFunction(t.renderer)?t.renderer.apply(this,[e,t,n]):t.data.match(/\w+\.\w+/)?(r=e.attributes||e,Luca.util.nestedValue(t.data,r)):(typeof e.get=="function"?e.get(t.data):void 0)||e[t.data]},double_click_handler:function(e){var t,n,r,i;return t=n=$(e.currentTarget),i=n.data("row-index"),r=this.collection.at(i),this.trigger("row:double:click",this,r,i)},click_handler:function(e){var t,n,r,i;return t=n=$(e.currentTarget),i=n.data("row-index"),r=this.collection.at(i),this.trigger("row:click",this,r,i),$("."+this.rowClass,this.body).removeClass("selected-row"),t.addClass("selected-row")}})}.call(this),function(){_.def("Luca.components.LoadMask")["extends"]("Luca.View")["with"]({className:"luca-ui-load-mask",bodyTemplate:"components/load_mask"})}.call(this),function(){_.def("Luca.components.NavBar")["extends"]("Luca.View")["with"]({fixed:!0,position:"top",className:"navbar",brand:"Luca.js",bodyTemplate:"nav_bar",bodyClassName:"luca-ui-navbar-body",beforeRender:function(){this.fixed&&this.$el.addClass("navbar-fixed-"+this.position),this.brand!=null&&this.content().append("<a class='brand' href='#'>"+this.brand+"</a>");if(this.template)return this.content().append(Luca.template(this.template,this))},render:function(){return this},content:function(){return this.$(".container").eq(0)}})}.call(this),function(){_.def("Luca.PageController")["extends"]("Luca.components.Controller")["with"]({version:2})}.call(this),function(){_.def("Luca.components.RecordManager")["extends"]("Luca.containers.CardView")["with"]({events:{"click .record-manager-grid .edit-link":"edit_handler","click .record-manager-filter .filter-button":"filter_handler","click .record-manager-filter .reset-button":"reset_filter_handler","click .add-button":"add_handler","click .refresh-button":"filter_handler","click .back-to-search-button":"back_to_search_handler"},record_manager:!0,initialize:function(e){var t=this;this.options=e!=null?e:{},Luca.containers.CardView.prototype.initialize.apply(this,arguments);if(!this.name)throw"Record Managers must specify a name";return _.bindAll(this,"add_handler","edit_handler","filter_handler","reset_filter_handler"),this.filterConfig&&_.extend(this.components[0][0],this.filterConfig),this.gridConfig&&_.extend(this.components[0][1],this.gridConfig),this.editorConfig&&_.extend(this.components[1][0],this.editorConfig),this.bind("after:card:switch",function(){t.activeCard===0&&t.trigger("activation:search",t);if(t.activeCard===1)return t.trigger("activation:editor",t)})},components:[{ctype:"split_view",relayFirstActivation:!0,components:[{ctype:"form_view"},{ctype:"grid_view"}]},{ctype:"form_view"}],getSearch:function(e,t){return e==null&&(e=!1),t==null&&(t=!0),e===!0&&this.activate(0),t===!0&&this.getEditor().clear(),_.first(this.components)},getFilter:function(){return _.first(this.getSearch().components)},getGrid:function(){return _.last(this.getSearch().components)},getCollection:function(){return this.getGrid().collection},getEditor:function(e,t){var n=this;return e==null&&(e=!1),t==null&&(t=!1),e===!0&&this.activate(1,function(e,t,n){return n.reset()}),_.last(this.components)},beforeRender:function(){var e;return this.$el.addClass(""+this.resource+"-manager"),(e=Luca.containers.CardView.prototype.beforeRender)!=null&&e.apply(this,arguments),this.$el.addClass(""+this.resource+" record-manager"),this.$el.data("resource",this.resource),$(this.getGrid().el).addClass(""+this.resource+" record-manager-grid"),$(this.getFilter().el).addClass(""+this.resource+" record-manager-filter"),$(this.getEditor().el).addClass(""+this.resource+" record-manager-editor")},afterRender:function(){var e,t,n,r,i,s,o=this;return(s=Luca.containers.CardView.prototype.afterRender)!=null&&s.apply(this,arguments),i=this,r=this.getGrid(),n=this.getFilter(),t=this.getEditor(),e=this.getCollection(),r.bind("row:double:click",function(e,n,r){return i.getEditor(!0),t.loadModel(n)}),t.bind("before:submit",function(){return $(".form-view-flash-container",o.el).html(""),$(".form-view-body",o.el).spin("large")}),t.bind("after:submit",function(){return $(".form-view-body",o.el).spin(!1)}),t.bind("after:submit:fatal_error",function(){return $(".form-view-flash-container",o.el).append("<li class='error'>There was an internal server error saving this record.  Please contact developers@benchprep.com to report this error.</li>"),$(".form-view-body",o.el).spin(!1)}),t.bind("after:submit:error",function(e,t,n){return _(n.errors).each(function(e){return $(".form-view-flash-container",o.el).append("<li class='error'>"+e+"</li>")})}),t.bind("after:submit:success",function(e,t,n){return $(".form-view-flash-container",o.el).append("<li class='success'>Successfully Saved Record</li>"),t.set(n.result),e.loadModel(t),r.refresh(),_.delay(function(){return $(".form-view-flash-container li.success",o.el).fadeOut(1e3),$(".form-view-flash-container",o.el).html("")},4e3)}),n.eachComponent(function(e){try{return e.bind("on:change",o.filter_handler)}catch(t){return}})},firstActivation:function(){return this.getGrid().trigger("first:activation",this,this.getGrid()),this.getFilter().trigger("first:activation",this,this.getGrid())},reload:function(){var e,t,n,r;return r=this,n=this.getGrid(),t=this.getFilter(),e=this.getEditor(),t.clear(),n.applyFilter()},manageRecord:function(e){var t,n=this;return t=this.getCollection().get(e),t?this.loadModel(t):(console.log("Could Not Find Model, building and fetching"),t=this.buildModel(),t.set({id:e},{silent:!0}),t.fetch({success:function(e,t){return n.loadModel(e)}}))},loadModel:function(e){return this.current_model=e,this.getEditor(!0).loadModel(this.current_model),this.trigger("model:loaded",this.current_model)},currentModel:function(){return this.getEditor(!1).currentModel()},buildModel:function(){var e,t,n;return t=this.getEditor(!1),e=this.getCollection(),e.add([{}],{silent:!0,at:0}),n=e.at(0)},createModel:function(){return this.loadModel(this.buildModel())},reset_filter_handler:function(e){return this.getFilter().clear(),this.getGrid().applyFilter(this.getFilter().getValues())},filter_handler:function(e){return this.getGrid().applyFilter(this.getFilter().getValues())},edit_handler:function(e){var t,n,r,i;return t=r=$(e.currentTarget),i=r.parents("tr").data("record-id"),i&&(n=this.getGrid().collection.get(i)),n||(n=this.getGrid().collection.at(row_index))},add_handler:function(e){var t,n,r;return t=n=$(e.currentTarget),r=n.parents(".record-manager").eq(0).data("resource")},destroy_handler:function(e){},back_to_search_handler:function(){}})}.call(this),function(){_.def("Luca.Router")["extends"]("Backbone.Router")["with"]({routes:{"":"default"},initialize:function(e){var t=this;return this.options=e,_.extend(this,this.options),this.routeHandlers=_(this.routes).values(),_(this.routeHandlers).each(function(e){return t.bind("route:"+e,function(){return t.trigger.apply(t,["change:navigation",e].concat(_(arguments).flatten()))})})},navigate:function(e,t){return t==null&&(t=!1),Backbone.Router.prototype.navigate.apply(this,arguments),this.buildPathFrom(Backbone.history.getFragment())},buildPathFrom:function(e){var t=this;return _(this.routes).each(function(n,r){var i,s;s=t._routeToRegExp(r);if(s.test(e))return i=t._extractParameters(s,e),t.trigger.apply(t,["change:navigation",n].concat(i))})}})}.call(this),function(){var e;_.def("Luca.components.TableView")["extends"]("Luca.components.CollectionView")["with"]({additionalClassNames:"table",tagName:"table",bodyTemplate:"table_view",bodyTagName:"tbody",bodyClassName:"table-body",itemTagName:"tr",stateful:!0,observeChanges:!0,columns:[],emptyText:"There are no results to display",itemRenderer:function(e,t){return Luca.components.TableView.rowRenderer.call(this,e,t)},emptyResults:function(){return this.$bodyEl().empty().append("<tr><td colspan="+this.columns.length+">"+this.emptyText+"</td></tr>")},initialize:function(e){var t=this;return this.options=e!=null?e:{},Luca.components.CollectionView.prototype.initialize.apply(this,arguments),this.defer(function(){return Luca.components.TableView.renderHeader.call(t,t.columns,t.$("thead")),t.$el.removeClass("row-fluid")}).until("before:render")}}),e=Backbone.View.prototype.make,Luca.components.TableView.renderHeader=function(t,n){var r,i,s,o,u,a;s=0,i=function(){var e,n,i;i=[];for(e=0,n=t.length;e<n;e++)r=t[e],i.push("<th data-col-index='"+s+"'>"+r.header+"</th>");return i}(),$(n).append(e("tr",{},i)),s=0,a=[];for(o=0,u=t.length;o<u;o++)r=t[o],r.width!=null&&a.push(this.$("th[data-col-index='"+s+"']",n).css("width",r.width));return a},Luca.components.TableView.rowRenderer=function(e,t,n){var r,i,s,o,u;o=this.columns,u=[];for(i=0,s=o.length;i<s;i++)r=o[i],u.push(Luca.components.TableView.renderColumn.call(this,r,e,t,n));return u},Luca.components.TableView.renderColumn=function(t,n,r,i){var s;return s=r.read(t.reader),_.isFunction(t.renderer)&&(s=t.renderer.call(this,s,r,t)),e("td",{},s)}}.call(this),function(){_.def("Luca.components.ToolbarDialog")["extends"]("Luca.View")["with"]({className:"luca-ui-toolbar-dialog span well",styles:{position:"absolute","z-Index":"3000","float":"left"},initialize:function(e){return this.options=e!=null?e:{},this._super("initialize",this,arguments)},createWrapper:function(){return this.make("div",{"class":"component-picker span4 well",style:"position: absolute; z-index:12000"})},show:function(){return this.$el.parent().show()},hide:function(){return this.$el.parent().hide()},toggle:function(){return this.$el.parent().toggle()}})}.call(this),function(){}.call(this),function(){}.call(this);